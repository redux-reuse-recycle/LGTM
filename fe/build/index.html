<!doctype html><html lang="en"><head><meta charset="utf-8"/><link rel="icon" href="./favicon.ico"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta name="theme-color" content="#000000"/><meta name="description" content="Web site created using create-react-app"/><link rel="apple-touch-icon" href="logo192.png"/><link rel="manifest" href="./manifest.json"/><title>LHTM</title><link href="./static/css/main.313401bd.chunk.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"></div><script>var line_level_profile = {"total_time": 143.20285534858704, "fetch_stuff.py": {"file_total_time": 9.735131978988647, "file_total_time_percent": 6.798140969529699, "2": {"hits": 2, "time": 5.936622619628906e-05, "time_per_hit": 2.968311309814453e-05, "percent": 4.14560352527739e-05, "line": "import asyncio"}, "3": {"hits": 1, "time": 5.0067901611328125e-06, "time_per_hit": 5.0067901611328125e-06, "percent": 3.496292129752016e-06, "line": "import datetime"}, "4": {"hits": 1, "time": 7.62939453125e-06, "time_per_hit": 7.62939453125e-06, "percent": 5.327683245336405e-06, "line": "import json"}, "5": {"hits": 1, "time": 6.67572021484375e-06, "time_per_hit": 6.67572021484375e-06, "percent": 4.661722839669354e-06, "line": "import logging"}, "6": {"hits": 1, "time": 6.4373016357421875e-06, "time_per_hit": 6.4373016357421875e-06, "percent": 4.495232738252592e-06, "line": "import os"}, "7": {"hits": 1, "time": 6.4373016357421875e-06, "time_per_hit": 6.4373016357421875e-06, "percent": 4.495232738252592e-06, "line": "import socket"}, "8": {"hits": 1, "time": 1.9788742065429688e-05, "time_per_hit": 1.9788742065429688e-05, "percent": 1.3818678417591302e-05, "line": "from urllib.parse import urlparse"}, "9": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "10": {"hits": 1, "time": 2.8848648071289062e-05, "time_per_hit": 2.8848648071289062e-05, "percent": 2.0145302271428283e-05, "line": "import aiofiles"}, "11": {"hits": 1, "time": 2.8371810913085938e-05, "time_per_hit": 2.8371810913085938e-05, "percent": 1.9812322068594758e-05, "line": "import aiohttp"}, "12": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "13": {"hits": 1, "time": 3.695487976074219e-05, "time_per_hit": 3.695487976074219e-05, "percent": 2.5805965719598213e-05, "line": "from util import common"}, "14": {"hits": 1, "time": 4.00543212890625e-05, "time_per_hit": 4.00543212890625e-05, "percent": 2.797033703801613e-05, "line": "from util.config import ConfigParser"}, "15": {"hits": 1, "time": 3.838539123535156e-05, "time_per_hit": 3.838539123535156e-05, "percent": 2.680490632809879e-05, "line": "from util.progress_bar import ProgressBar"}, "16": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "17": {"hits": 1, "time": 2.1219253540039062e-05, "time_per_hit": 2.1219253540039062e-05, "percent": 1.4817619026091878e-05, "line": "logging.captureWarnings(True)"}, "18": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "19": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "20": {"hits": 3, "time": 5.316734313964844e-05, "time_per_hit": 1.7722447713216145e-05, "percent": 3.712729261593808e-05, "line": "class Thingy(object):"}, "21": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "22": {"hits": 1, "time": 2.86102294921875e-06, "time_per_hit": 2.86102294921875e-06, "percent": 1.997881217001152e-06, "line": "    HTTP_PAGE_SIZE = 1000"}, "23": {"hits": 1, "time": 5.245208740234375e-06, "time_per_hit": 5.245208740234375e-06, "percent": 3.662782231168779e-06, "line": "    MAX_FILE_SIZE = 10000"}, "24": {"hits": 1, "time": 5.245208740234375e-06, "time_per_hit": 5.245208740234375e-06, "percent": 3.662782231168779e-06, "line": "    MAX_REQUEST_COUNT = 50"}, "25": {"hits": 1, "time": 5.245208740234375e-06, "time_per_hit": 5.245208740234375e-06, "percent": 3.662782231168779e-06, "line": "    MAX_RETRY_COUNT = 10"}, "26": {"hits": 1, "time": 5.245208740234375e-06, "time_per_hit": 5.245208740234375e-06, "percent": 3.662782231168779e-06, "line": "    REQUEST_BACKOFF_RATE = 0.5"}, "27": {"hits": 1, "time": 5.245208740234375e-06, "time_per_hit": 5.245208740234375e-06, "percent": 3.662782231168779e-06, "line": "    REQUEST_SLEEP_TIME = 10"}, "28": {"hits": 1, "time": 4.76837158203125e-06, "time_per_hit": 4.76837158203125e-06, "percent": 3.3298020283352535e-06, "line": "    REQUEST_TIMEOUT = 60"}, "29": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "30": {"hits": 2, "time": 8.58306884765625e-06, "time_per_hit": 4.291534423828125e-06, "percent": 5.9936436510034565e-06, "line": "    def __init__(self, config_file, data_set, session, log_level='info', log_file=None):"}, "31": {"hits": 1, "time": 2.86102294921875e-06, "time_per_hit": 2.86102294921875e-06, "percent": 1.997881217001152e-06, "line": "        self._slice_tasks = []"}, "32": {"hits": 1, "time": 2.6226043701171875e-06, "time_per_hit": 2.6226043701171875e-06, "percent": 1.8313911155843894e-06, "line": "        self._progress_bar = None"}, "33": {"hits": 1, "time": 2.384185791015625e-06, "time_per_hit": 2.384185791015625e-06, "percent": 1.6649010141676268e-06, "line": "        self._session = session"}, "34": {"hits": 1, "time": 1.0728836059570312e-05, "time_per_hit": 1.0728836059570312e-05, "percent": 7.49205456375432e-06, "line": "        self._request_lock = asyncio.BoundedSemaphore(self.MAX_REQUEST_COUNT)"}, "35": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "36": {"hits": 1, "time": 1.1444091796875e-05, "time_per_hit": 1.1444091796875e-05, "percent": 7.991524868004607e-06, "line": "        self._config = ConfigParser(config_file)"}, "37": {"hits": 1, "time": 3.5762786865234375e-06, "time_per_hit": 3.5762786865234375e-06, "percent": 2.49735152125144e-06, "line": "        self._data_set = data_set"}, "38": {"hits": 1, "time": 2.86102294921875e-06, "time_per_hit": 2.86102294921875e-06, "percent": 1.997881217001152e-06, "line": "        data_set_config = self._config.data_sets[self._data_set]"}, "39": {"hits": 1, "time": 4.0531158447265625e-06, "time_per_hit": 4.0531158447265625e-06, "percent": 2.8303317240849656e-06, "line": "        self._data_set_start_time = datetime.datetime.strptime("}, "40": {"hits": 1, "time": 2.384185791015625e-05, "time_per_hit": 2.384185791015625e-05, "percent": 1.6649010141676266e-05, "line": "            data_set_config['start_time'], '%Y-%m-%dT%H:%M:%S')"}, "41": {"hits": 1, "time": 4.0531158447265625e-06, "time_per_hit": 4.0531158447265625e-06, "percent": 2.8303317240849656e-06, "line": "        self._data_set_end_time = datetime.datetime.strptime("}, "42": {"hits": 1, "time": 1.0728836059570312e-05, "time_per_hit": 1.0728836059570312e-05, "percent": 7.49205456375432e-06, "line": "            data_set_config['end_time'], '%Y-%m-%dT%H:%M:%S')"}, "43": {"hits": 1, "time": 4.5299530029296875e-06, "time_per_hit": 4.5299530029296875e-06, "percent": 3.163311926918491e-06, "line": "        self._output_path = f'{self._config.data_path}/{self._data_set}'"}, "44": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "45": {"hits": 1, "time": 9.298324584960938e-06, "time_per_hit": 9.298324584960938e-06, "percent": 6.4931139552537444e-06, "line": "        if not os.path.exists(self._config.logging_path):"}, "46": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            os.makedirs(self._config.logging_path)"}, "47": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "48": {"hits": 1, "time": 8.344650268554688e-06, "time_per_hit": 8.344650268554688e-06, "percent": 5.827153549586694e-06, "line": "        self._logger = logging.getLogger(__name__)"}, "49": {"hits": 1, "time": 4.76837158203125e-06, "time_per_hit": 4.76837158203125e-06, "percent": 3.3298020283352535e-06, "line": "        log_level = getattr(logging, log_level.upper())"}, "50": {"hits": 1, "time": 7.62939453125e-06, "time_per_hit": 7.62939453125e-06, "percent": 5.327683245336405e-06, "line": "        self._logger.setLevel(log_level)"}, "51": {"hits": 1, "time": 1.1444091796875e-05, "time_per_hit": 1.1444091796875e-05, "percent": 7.991524868004607e-06, "line": "        file_handler = logging.FileHandler(f'{self._config.logging_path}/{log_file or self._data_set}.txt')"}, "52": {"hits": 1, "time": 9.5367431640625e-06, "time_per_hit": 9.5367431640625e-06, "percent": 6.659604056670507e-06, "line": "        file_handler.setLevel(log_level)"}, "53": {"hits": 1, "time": 7.3909759521484375e-06, "time_per_hit": 7.3909759521484375e-06, "percent": 5.161193143919642e-06, "line": "        self._logger.addHandler(file_handler)"}, "54": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "55": {"hits": 1, "time": 3.337860107421875e-06, "time_per_hit": 3.337860107421875e-06, "percent": 2.330861419834677e-06, "line": "        env = data_set_config['filters']['env'].lower()"}, "56": {"hits": 1, "time": 2.6226043701171875e-06, "time_per_hit": 2.6226043701171875e-06, "percent": 1.8313911155843894e-06, "line": "        if env in ['prod', 'LT']:"}, "57": {"hits": 1, "time": 1.0967254638671875e-05, "time_per_hit": 1.0967254638671875e-05, "percent": 7.658544665171082e-06, "line": "            parsed_url = urlparse(self._config.elasticsearch_config['prod_url'])"}, "58": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        else:"}, "59": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            parsed_url = urlparse(self._config.elasticsearch_config['dev_url'])"}, "60": {"hits": 1, "time": 1.6927719116210938e-05, "time_per_hit": 1.6927719116210938e-05, "percent": 1.182079720059015e-05, "line": "        self._host = parsed_url.hostname"}, "61": {"hits": 1, "time": 7.3909759521484375e-06, "time_per_hit": 7.3909759521484375e-06, "percent": 5.161193143919642e-06, "line": "        self._port = parsed_url.port"}, "62": {"hits": 1, "time": 2.86102294921875e-06, "time_per_hit": 2.86102294921875e-06, "percent": 1.997881217001152e-06, "line": "        self._filter = data_set_config['filters']"}, "63": {"hits": 1, "time": 3.0994415283203125e-06, "time_per_hit": 3.0994415283203125e-06, "percent": 2.1643713184179145e-06, "line": "        self._query_parameters = data_set_config.get('query_parameters', {})"}, "64": {"hits": 1, "time": 2.6226043701171875e-06, "time_per_hit": 2.6226043701171875e-06, "percent": 1.8313911155843894e-06, "line": "        self._schema = data_set_config['schema']"}, "65": {"hits": 1, "time": 4.291534423828125e-06, "time_per_hit": 4.291534423828125e-06, "percent": 2.9968218255017282e-06, "line": "        self._auth = aiohttp.BasicAuth("}, "66": {"hits": 1, "time": 2.86102294921875e-06, "time_per_hit": 2.86102294921875e-06, "percent": 1.997881217001152e-06, "line": "            self._config.elasticsearch_config['user'],"}, "67": {"hits": 1, "time": 9.775161743164062e-06, "time_per_hit": 9.775161743164062e-06, "percent": 6.82609415808727e-06, "line": "            self._config.elasticsearch_config['password']"}, "68": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        )"}, "69": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "70": {"hits": 2, "time": 1.6927719116210938e-05, "time_per_hit": 8.463859558105469e-06, "percent": 1.182079720059015e-05, "line": "    def _progress_bar_init(self, total_records):"}, "71": {"hits": 1, "time": 3.528594970703125e-05, "time_per_hit": 3.528594970703125e-05, "percent": 2.4640535009680876e-05, "line": "        self._progress_bar = ProgressBar(f'Fetching {total_records} records')"}, "72": {"hits": 1, "time": 2.7894973754882812e-05, "time_per_hit": 2.7894973754882812e-05, "percent": 1.9479341865761232e-05, "line": "        self._progress_bar.set_steps(total_records * 2)"}, "73": {"hits": 1, "time": 3.2901763916015625e-05, "time_per_hit": 3.2901763916015625e-05, "percent": 2.297563399551325e-05, "line": "        self._progress_bar.update(steps=0)"}, "74": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "75": {"hits": 2, "time": 9.5367431640625e-06, "time_per_hit": 4.76837158203125e-06, "percent": 6.659604056670507e-06, "line": "    async def run(self):"}, "76": {"hits": 1, "time": 2.384185791015625e-06, "time_per_hit": 2.384185791015625e-06, "percent": 1.6649010141676268e-06, "line": "        total_records = await self._search("}, "77": {"hits": 6, "time": 0.00019669532775878906, "time_per_hit": 3.2782554626464844e-05, "percent": 0.0001373543336688292, "line": "            self._data_set_start_time, self._data_set_end_time)"}, "78": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "79": {"hits": 1, "time": 9.059906005859375e-06, "time_per_hit": 9.059906005859375e-06, "percent": 6.326623853836982e-06, "line": "        if total_records == 0:"}, "80": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            message = f'No results found between {self._data_set_start_time} and {self._data_set_end_time}.'"}, "81": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            print(message)"}, "82": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            self._logger.warning(message)"}, "83": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            return 0"}, "84": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "85": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        # Create output directory for the data"}, "86": {"hits": 1, "time": 3.743171691894531e-05, "time_per_hit": 3.743171691894531e-05, "percent": 2.613894592243174e-05, "line": "        if not os.path.exists(self._output_path):"}, "87": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            self._logger.debug(f'Creating output path: {self._output_path}')"}, "88": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            os.makedirs(self._output_path)"}, "89": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "90": {"hits": 1, "time": 3.4332275390625e-05, "time_per_hit": 3.4332275390625e-05, "percent": 2.3974574604013826e-05, "line": "        self._progress_bar_init(total_records)"}, "91": {"hits": 1, "time": 1.1205673217773438e-05, "time_per_hit": 1.1205673217773438e-05, "percent": 7.825034766587845e-06, "line": "        await self._build_time_slices("}, "92": {"hits": 14, "time": 0.0003180503845214844, "time_per_hit": 2.2717884608677457e-05, "percent": 0.0002220977952899614, "line": "            self._data_set_start_time, self._data_set_end_time, total_records)"}, "93": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "94": {"hits": 2, "time": 9.226799011230469e-05, "time_per_hit": 4.6133995056152344e-05, "percent": 6.443166924828715e-05, "line": "        await asyncio.gather(*self._slice_tasks)"}, "95": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "96": {"hits": 1, "time": 2.1696090698242188e-05, "time_per_hit": 2.1696090698242188e-05, "percent": 1.5150599228925403e-05, "line": "        self._progress_bar.update(done=True)"}, "97": {"hits": 1, "time": 5.245208740234375e-06, "time_per_hit": 5.245208740234375e-06, "percent": 3.662782231168779e-06, "line": "        return total_records"}, "98": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "99": {"hits": 2, "time": 1.8835067749023438e-05, "time_per_hit": 9.417533874511719e-06, "percent": 1.3152718011924252e-05, "line": "    async def _build_time_slices(self, start_time, end_time, num_results):"}, "100": {"hits": 1, "time": 1.1920928955078125e-05, "time_per_hit": 1.1920928955078125e-05, "percent": 8.324505070838133e-06, "line": "        if num_results > self.MAX_FILE_SIZE:"}, "101": {"hits": 1, "time": 3.5762786865234375e-05, "time_per_hit": 3.5762786865234375e-05, "percent": 2.4973515212514402e-05, "line": "            self._logger.debug(f'{num_results} larger than max file size {self.MAX_FILE_SIZE}')"}, "102": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "103": {"hits": 1, "time": 1.6689300537109375e-05, "time_per_hit": 1.6689300537109375e-05, "percent": 1.1654307099173388e-05, "line": "            num_slices = int(num_results / self.MAX_FILE_SIZE) + ("}, "104": {"hits": 1, "time": 1.3113021850585938e-05, "time_per_hit": 1.3113021850585938e-05, "percent": 9.156955577921946e-06, "line": "                num_results % self.MAX_FILE_SIZE != 0)"}, "105": {"hits": 1, "time": 4.029273986816406e-05, "time_per_hit": 4.029273986816406e-05, "percent": 2.813682713943289e-05, "line": "            self._logger.info(f'Splitting time range into {num_slices} slices.')"}, "106": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "107": {"hits": 1, "time": 4.124641418457031e-05, "time_per_hit": 4.124641418457031e-05, "percent": 2.880278754509994e-05, "line": "            time_ranges = self._split_datetime_range(start_time, end_time, num_slices)"}, "108": {"hits": 14, "time": 0.00013828277587890625, "time_per_hit": 9.87734113420759e-06, "percent": 9.656425882172235e-05, "line": "            for i in range(1, len(time_ranges)):"}, "109": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                # Since the number of logs per slice is not uniform,"}, "110": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                # if we have more than 2 slices we need to check"}, "111": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                # that each slice is still under the file size limit"}, "112": {"hits": 13, "time": 0.00011467933654785156, "time_per_hit": 8.821487426757812e-06, "percent": 8.008173878146284e-05, "line": "                if num_slices > 2:"}, "113": {"hits": 26, "time": 0.0013942718505859375, "time_per_hit": 5.3625840407151445e-05, "percent": 0.000973634113085228, "line": "                    num_logs = await self._search(time_ranges[i-1], time_ranges[i])"}, "114": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                else:"}, "115": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                    # The two slices probably won't be equal sized"}, "116": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                    # but we can use this as a reasonable estimate"}, "117": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                    # to avoid extra search requests"}, "118": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                    num_logs = num_results / 2"}, "119": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "120": {"hits": 13, "time": 0.0001552104949951172, "time_per_hit": 1.1939268845778246e-05, "percent": 0.0001083850560223125, "line": "                if num_logs < self.MAX_FILE_SIZE:"}, "121": {"hits": 13, "time": 0.0008492469787597656, "time_per_hit": 6.532669067382812e-05, "percent": 0.0005930377412465087, "line": "                    self._logger.debug(f'Added slice {i} from {time_ranges[i-1]} to {time_ranges[i]}.')"}, "122": {"hits": 13, "time": 0.0001709461212158203, "time_per_hit": 1.3149701631986178e-05, "percent": 0.00011937340271581883, "line": "                    self._slice_tasks.append(self._run_slice("}, "123": {"hits": 13, "time": 0.00017380714416503906, "time_per_hit": 1.3369780320387621e-05, "percent": 0.00012137128393281999, "line": "                        i, time_ranges[i-1], time_ranges[i]))"}, "124": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                elif num_logs > 0:"}, "125": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                    await self._build_time_slices(time_ranges[i-1], time_ranges[i], num_logs)"}, "126": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        else:"}, "127": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            self._slice_tasks.append(self._run_slice(1, start_time, end_time))"}, "128": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "129": {"hits": 15, "time": 0.0001385211944580078, "time_per_hit": 9.234746297200521e-06, "percent": 9.673074892313911e-05, "line": "    async def _search(self, start_time, end_time):"}, "130": {"hits": 14, "time": 0.0004911422729492188, "time_per_hit": 3.5081590924944195e-05, "percent": 0.0003429696089185311, "line": "        search_body = self._build_query_body(start_time, end_time)"}, "131": {"hits": 14, "time": 0.0006163120269775391, "time_per_hit": 4.402228764125279e-05, "percent": 0.0004303769121623315, "line": "        self._logger.debug(f'Sending search request for time range {start_time} to {end_time}')"}, "132": {"hits": 14, "time": 0.00014901161193847656, "time_per_hit": 1.0643686567034041e-05, "percent": 0.00010405631338547666, "line": "        async with self._session.get("}, "133": {"hits": 14, "time": 0.00016617774963378906, "time_per_hit": 1.1869839259556361e-05, "percent": 0.00011604360068748359, "line": "            f'https://{self._host}:{self._port}/*:daily-*/_count',"}, "134": {"hits": 14, "time": 0.00011348724365234375, "time_per_hit": 8.106231689453125e-06, "percent": 7.924928827437903e-05, "line": "            json=search_body,"}, "135": {"hits": 14, "time": 0.00011563301086425781, "time_per_hit": 8.259500776018416e-06, "percent": 8.07476991871299e-05, "line": "            auth=self._auth,"}, "136": {"hits": 32, "time": 0.001287221908569336, "time_per_hit": 4.022568464279175e-05, "percent": 0.0008988800575491017, "line": "            timeout=self.REQUEST_TIMEOUT"}, "137": {"hits": 14, "time": 0.00015234947204589844, "time_per_hit": 1.0882105146135603e-05, "percent": 0.00010638717480531135, "line": "        ) as response:"}, "138": {"hits": 14, "time": 0.00015115737915039062, "time_per_hit": 1.079695565359933e-05, "percent": 0.00010555472429822753, "line": "            if response.status == 401:"}, "139": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                message = f'Elasticsearch request not authorized. ' \\"}, "140": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                          f'Check credentials in config file {self._config.config_file}'"}, "141": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                self._logger.error(message)"}, "142": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                print(message)"}, "143": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                return 0"}, "144": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "145": {"hits": 14, "time": 0.0007305145263671875, "time_per_hit": 5.217960902622768e-05, "percent": 0.0005101256707409608, "line": "            count_response = await response.json()"}, "146": {"hits": 14, "time": 0.0008938312530517578, "time_per_hit": 6.384508950369698e-05, "percent": 0.0006241713902114432, "line": "            self._logger.debug(f'Got search response: {count_response}')"}, "147": {"hits": 14, "time": 0.0006117820739746094, "time_per_hit": 4.3698719569614953e-05, "percent": 0.000427213600235413, "line": "            return count_response['count']"}, "148": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "149": {"hits": 14, "time": 3.886222839355469e-05, "time_per_hit": 2.7758734566824776e-06, "percent": 2.7137886530932315e-05, "line": "    async def _run_slice(self, slice_num, start_time, end_time):"}, "150": {"hits": 5223, "time": 0.05017518997192383, "time_per_hit": 9.606584333127289e-06, "percent": 0.035037841843157704, "line": "        logs = await self._fetch(start_time, end_time)"}, "151": {"hits": 13, "time": 0.00010919570922851562, "time_per_hit": 8.399669940655049e-06, "percent": 7.62524664488773e-05, "line": "        self._logger.debug(f'Fetched {len(logs)} logs.')"}, "152": {"hits": 52, "time": 0.0829322338104248, "time_per_hit": 0.001594850650200477, "percent": 0.05791241634711098, "line": "        await self._write(logs, slice_num), slice_num"}, "153": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "154": {"hits": 14, "time": 5.1021575927734375e-05, "time_per_hit": 3.6443982805524555e-06, "percent": 3.562888170318721e-05, "line": "    async def _fetch(self, start_time, end_time):"}, "155": {"hits": 13, "time": 5.6743621826171875e-05, "time_per_hit": 4.3648939866286055e-06, "percent": 3.9624644137189516e-05, "line": "        logs = []"}, "156": {"hits": 13, "time": 4.57763671875e-05, "time_per_hit": 3.521259014423077e-06, "percent": 3.196609947201843e-05, "line": "        offset = 0"}, "157": {"hits": 13, "time": 5.269050598144531e-05, "time_per_hit": 4.0531158447265625e-06, "percent": 3.679431241310455e-05, "line": "        keep_fetching = True"}, "158": {"hits": 142, "time": 0.0003638267517089844, "time_per_hit": 2.5621602233027067e-06, "percent": 0.00025406389476197985, "line": "        while keep_fetching:"}, "159": {"hits": 129, "time": 0.0003216266632080078, "time_per_hit": 2.493229947348898e-06, "percent": 0.00022459514681121283, "line": "            backoff = False"}, "160": {"hits": 129, "time": 0.0002510547637939453, "time_per_hit": 1.946160959642987e-06, "percent": 0.0001753140767918511, "line": "            fail_count = 0"}, "161": {"hits": 129, "time": 0.0003247261047363281, "time_per_hit": 2.5172566258630085e-06, "percent": 0.00022675951812963077, "line": "            query = self._build_query_body(start_time, end_time, self.HTTP_PAGE_SIZE,"}, "162": {"hits": 129, "time": 0.0015912055969238281, "time_per_hit": 1.2334927107936653e-05, "percent": 0.001111154936855474, "line": "                                           offset, sort=True)"}, "163": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "164": {"hits": 130, "time": 0.00036072731018066406, "time_per_hit": 2.774825462928185e-06, "percent": 0.0002518995234435619, "line": "            while fail_count < self.MAX_RETRY_COUNT:"}, "165": {"hits": 130, "time": 0.0008831024169921875, "time_per_hit": 6.793095515324519e-06, "percent": 0.000616679335647689, "line": "                self._logger.debug(f'Waiting for request lock...')"}, "166": {"hits": 130, "time": 0.0011105537414550781, "time_per_hit": 8.542721088115985e-06, "percent": 0.0007755108923992805, "line": "                async with self._request_lock:"}, "167": {"hits": 130, "time": 0.0008428096771240234, "time_per_hit": 6.483151362492488e-06, "percent": 0.0005885425085082561, "line": "                    self._logger.debug(f'Obtained request lock, sending fetch request...')"}, "168": {"hits": 130, "time": 0.0003101825714111328, "time_per_hit": 2.386019780085637e-06, "percent": 0.00021660362194320822, "line": "                    try:"}, "169": {"hits": 130, "time": 0.0003402233123779297, "time_per_hit": 2.6171024029071515e-06, "percent": 0.00023758137472172032, "line": "                        async with self._session.get("}, "170": {"hits": 130, "time": 0.0003955364227294922, "time_per_hit": 3.04258786714994e-06, "percent": 0.0002762070782504093, "line": "                                f'https://{self._host}:{self._port}/*:daily-*/_search',"}, "171": {"hits": 130, "time": 0.0002696514129638672, "time_per_hit": 2.0742416381835936e-06, "percent": 0.00018830030470235858, "line": "                                json=query,"}, "172": {"hits": 130, "time": 0.0002644062042236328, "time_per_hit": 2.0338938786433293e-06, "percent": 0.0001846375224711898, "line": "                                auth=self._auth,"}, "173": {"hits": 320, "time": 0.006619691848754883, "time_per_hit": 2.068653702735901e-05, "percent": 0.0046225976658364155, "line": "                                timeout=self.REQUEST_TIMEOUT"}, "174": {"hits": 129, "time": 0.005762338638305664, "time_per_hit": 4.466929176981135e-05, "percent": 0.004023899261141737, "line": "                        ) as response:"}, "175": {"hits": 5150, "time": 0.05323147773742676, "time_per_hit": 1.0336209269403254e-05, "percent": 0.03717207845321918, "line": "                            result = await response.json()"}, "176": {"hits": 129, "time": 0.0029838085174560547, "time_per_hit": 2.3130298584930656e-05, "percent": 0.002083623619230785, "line": "                            self._logger.debug(f'Got fetch response: {response}')"}, "177": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "178": {"hits": 129, "time": 0.00039458274841308594, "time_per_hit": 3.0587809954502785e-06, "percent": 0.00027554111784474223, "line": "                            if result['_shards']['failed'] > 0:"}, "179": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                self._logger.warning(f'{result[\"_shards\"][\"failed\"]} request shards failed!')"}, "180": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                self._logger.warning(f'Failure reason: {result[\"_shards\"][\"failures\"][0][\"reason\"]}')"}, "181": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "182": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                # If a request failed, it's most likely due to hitting the request queue size limit"}, "183": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                if result['_shards']['failures'][0]['reason']['type'] == 'es_rejected_execution_exception':"}, "184": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                    self._logger.warning(f'Hit request queue limit.')"}, "185": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                    if backoff:"}, "186": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                        # Second time we hit the request queue limit"}, "187": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                        # Lower the number of simultaneous requests we're sending"}, "188": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                        self.MAX_REQUEST_COUNT = max("}, "189": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                            int(self.MAX_REQUEST_COUNT * self.REQUEST_BACKOFF_RATE), 1)"}, "190": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                        self._logger.warning(f'Max request count lowered to {self.MAX_REQUEST_COUNT}')"}, "191": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                    else:"}, "192": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                        backoff = True"}, "193": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                        # Try sleeping for a while to wait for the request queue to empty"}, "194": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                        self._logger.debug(f'Request sleeping for {self.REQUEST_SLEEP_TIME} seconds...')"}, "195": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                        await asyncio.sleep(self.REQUEST_SLEEP_TIME)"}, "196": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "197": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                continue  # try again"}, "198": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                            else:"}, "199": {"hits": 129, "time": 0.0003211498260498047, "time_per_hit": 2.489533535269804e-06, "percent": 0.0002242621666083793, "line": "                                results = result['hits']['hits']"}, "200": {"hits": 129, "time": 0.00039839744567871094, "time_per_hit": 3.0883522920830305e-06, "percent": 0.0002782049594674104, "line": "                                del result"}, "201": {"hits": 129, "time": 0.0026502609252929688, "time_per_hit": 2.054465833560441e-05, "percent": 0.0018507039673487339, "line": "                                logs.extend(results)"}, "202": {"hits": 129, "time": 0.00043964385986328125, "time_per_hit": 3.408091936924661e-06, "percent": 0.00030700774701251037, "line": "                                num_logs = len(results)"}, "203": {"hits": 129, "time": 0.000530242919921875, "time_per_hit": 4.110410231952519e-06, "percent": 0.0003702739855508802, "line": "                                del results"}, "204": {"hits": 129, "time": 0.0012149810791015625, "time_per_hit": 9.418457977531492e-06, "percent": 0.0008484335568198226, "line": "                                self._progress_bar.update(steps=num_logs)"}, "205": {"hits": 129, "time": 0.0010607242584228516, "time_per_hit": 8.222668669944586e-06, "percent": 0.0007407144612031771, "line": "                                self._logger.debug(f'Fetched {num_logs} logs.')"}, "206": {"hits": 129, "time": 0.0003418922424316406, "time_per_hit": 2.6503274607103925e-06, "percent": 0.00023874680543163767, "line": "                                offset += num_logs"}, "207": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "208": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                                # If we didn't get a full page of logs, or we've filled the file, we're done"}, "209": {"hits": 129, "time": 0.0003867149353027344, "time_per_hit": 2.9977901961452275e-06, "percent": 0.00027004694449798907, "line": "                                if num_logs != self.HTTP_PAGE_SIZE or offset == self.MAX_FILE_SIZE:"}, "210": {"hits": 13, "time": 3.361701965332031e-05, "time_per_hit": 2.5859245887169472e-06, "percent": 2.3475104299763536e-05, "line": "                                    keep_fetching = False"}, "211": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "212": {"hits": 129, "time": 0.002488374710083008, "time_per_hit": 1.9289726434752e-05, "percent": 0.001737657188486752, "line": "                                break  # done!"}, "213": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "214": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                    # Sometimes get these errors, not sure why."}, "215": {"hits": 1, "time": 4.5299530029296875e-06, "time_per_hit": 4.5299530029296875e-06, "percent": 3.163311926918491e-06, "line": "                    except aiohttp.client_exceptions.ServerDisconnectedError:"}, "216": {"hits": 1, "time": 3.0994415283203125e-06, "time_per_hit": 3.0994415283203125e-06, "percent": 2.1643713184179145e-06, "line": "                        fail_count += 1"}, "217": {"hits": 1, "time": 2.2649765014648438e-05, "time_per_hit": 2.2649765014648438e-05, "percent": 1.5816559634592454e-05, "line": "                        self._logger.error(f'Got ServerDisconnectedError, increasing fail count to {fail_count}.')"}, "218": {"hits": 13, "time": 3.314018249511719e-05, "time_per_hit": 2.5492448073167066e-06, "percent": 2.314212409693001e-05, "line": "        return logs"}, "219": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "220": {"hits": 14, "time": 5.626678466796875e-05, "time_per_hit": 4.019056047712054e-06, "percent": 3.929166393435599e-05, "line": "    async def _write(self, logs, slice_num):"}, "221": {"hits": 13, "time": 4.3392181396484375e-05, "time_per_hit": 3.337860107421875e-06, "percent": 3.0301198457850807e-05, "line": "        formatted_logs = []"}, "222": {"hits": 123152, "time": 0.19799208641052246, "time_per_hit": 1.607705002034254e-06, "percent": 0.13825987333043496, "line": "        while logs:"}, "223": {"hits": 123139, "time": 0.39803290367126465, "time_per_hit": 3.232387007132303e-06, "percent": 0.2779503961023442, "line": "            log = logs.pop()['_source']"}, "224": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "225": {"hits": 123139, "time": 0.2159428596496582, "time_per_hit": 1.7536512368109063e-06, "percent": 0.15079507955620444, "line": "            log_dict = {}"}, "226": {"hits": 1108251, "time": 1.814129114151001, "time_per_hit": 1.6369298237953324e-06, "percent": 1.2668246800910599, "line": "            for field, _, _ in common.LOG_SCHEMAS[self._schema]:"}, "227": {"hits": 985112, "time": 1.7247114181518555, "time_per_hit": 1.7507769859182056e-06, "percent": 1.20438340000521, "line": "                field_levels = field.split('.')"}, "228": {"hits": 985112, "time": 1.6272215843200684, "time_per_hit": 1.651813787995749e-06, "percent": 1.136305264555693, "line": "                if len(field_levels) > 1:"}, "229": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                    log_data = log"}, "230": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                    for nested_field in field_levels:"}, "231": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                        log_data = log_data[nested_field]"}, "232": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                    log_dict[field] = log_data"}, "233": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                else:"}, "234": {"hits": 985112, "time": 1.6699438095092773, "time_per_hit": 1.695181674275897e-06, "percent": 1.1661386258285626, "line": "                    log_data = log[field]"}, "235": {"hits": 985112, "time": 1.6000761985778809, "time_per_hit": 1.6242581539742494e-06, "percent": 1.1173493675687862, "line": "                log_dict[field] = log_data"}, "236": {"hits": 123139, "time": 0.2363910675048828, "time_per_hit": 1.919709170164471e-06, "percent": 0.1650742695943145, "line": "            formatted_logs.append(log_dict)"}, "237": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "238": {"hits": 13, "time": 5.459785461425781e-05, "time_per_hit": 4.199834970327524e-06, "percent": 3.812623322443865e-05, "line": "        file_name = f'{self._data_set}_{slice_num}'"}, "239": {"hits": 13, "time": 4.744529724121094e-05, "time_per_hit": 3.6496382493239184e-06, "percent": 3.3131530181935774e-05, "line": "        output_file = f'{self._output_path}/{file_name}.json'"}, "240": {"hits": 26, "time": 0.0003616809844970703, "time_per_hit": 1.3910807096041166e-05, "percent": 0.00025256548384922897, "line": "        async with aiofiles.open(output_file, 'w') as outfile:"}, "241": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            # Indent is set to 0 to reduce file size"}, "242": {"hits": 13, "time": 0.00032901763916015625, "time_per_hit": 2.5309049166165867e-05, "percent": 0.00022975633995513247, "line": "            json_logs = json.dumps(formatted_logs, indent=0, sort_keys=True)"}, "243": {"hits": 13, "time": 0.00021386146545410156, "time_per_hit": 1.6450881958007812e-05, "percent": 0.0001493416209708361, "line": "            self._logger.debug(f'Writing {len(json_logs)} logs to file {output_file}.')"}, "244": {"hits": 39, "time": 0.0005407333374023438, "time_per_hit": 1.3864957369290865e-05, "percent": 0.00037759955001321775, "line": "            await outfile.write(json_logs)"}, "245": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "246": {"hits": 13, "time": 0.0001385211944580078, "time_per_hit": 1.0655476496769832e-05, "percent": 9.673074892313911e-05, "line": "        self._progress_bar.update(steps=len(formatted_logs))"}, "247": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "248": {"hits": 144, "time": 0.0007061958312988281, "time_per_hit": 4.904137717352973e-06, "percent": 0.000493143680396451, "line": "    def _build_query_body(self, start_time, end_time, count=None, offset=None, sort=False):"}, "249": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        filters = ["}, "250": {"hits": 143, "time": 0.001622915267944336, "time_per_hit": 1.1349057817792559e-05, "percent": 0.0011332981203439035, "line": "            {'range': {'@timestamp': {'gte': start_time.isoformat(), 'lt': end_time.isoformat()}}}]"}, "251": {"hits": 572, "time": 0.002017498016357422, "time_per_hit": 3.527094434191297e-06, "percent": 0.0014088392381886457, "line": "        for filter_term, filter_value in self._filter.items():"}, "252": {"hits": 429, "time": 0.0012655258178710938, "time_per_hit": 2.949943631401151e-06, "percent": 0.0008837294583201763, "line": "            if filter_term == 'env':"}, "253": {"hits": 143, "time": 0.0005495548248291016, "time_per_hit": 3.843040733070641e-06, "percent": 0.0003837596837656379, "line": "                filters.append({'term': {filter_term: filter_value.upper()}})"}, "254": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            else:"}, "255": {"hits": 286, "time": 0.0010144710540771484, "time_per_hit": 3.5471015876823374e-06, "percent": 0.0007084153815283252, "line": "                filters.append({'term': {filter_term: filter_value}})"}, "256": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "257": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        # Build query parameters"}, "258": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        must_parameters = ["}, "259": {"hits": 572, "time": 0.0014903545379638672, "time_per_hit": 2.6055149265102573e-06, "percent": 0.0010407296239561834, "line": "            {'match_phrase': {'message': parameter}}"}, "260": {"hits": 286, "time": 0.001833200454711914, "time_per_hit": 6.409791799692007e-06, "percent": 0.0012801423897934882, "line": "            for parameter in self._query_parameters.get('must', [])]"}, "261": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        must_not_parameters = ["}, "262": {"hits": 572, "time": 0.0013437271118164062, "time_per_hit": 2.3491732724063047e-06, "percent": 0.0009383382115848744, "line": "            {'match_phrase': {'message': parameter}}"}, "263": {"hits": 286, "time": 0.0015692710876464844, "time_per_hit": 5.486961844917777e-06, "percent": 0.0010958378475251318, "line": "            for parameter in self._query_parameters.get('must_not', [])]"}, "264": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "265": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        query = {"}, "266": {"hits": 143, "time": 0.0003924369812011719, "time_per_hit": 2.7443145538543487e-06, "percent": 0.00027404270693199136, "line": "            'query': {"}, "267": {"hits": 143, "time": 0.00036215782165527344, "time_per_hit": 2.5325721794075064e-06, "percent": 0.0002528984640520625, "line": "                'bool': {"}, "268": {"hits": 143, "time": 0.0003559589385986328, "time_per_hit": 2.489223346843586e-06, "percent": 0.0002485697214152267, "line": "                    'filter': filters,"}, "269": {"hits": 143, "time": 0.0003528594970703125, "time_per_hit": 2.467548930561626e-06, "percent": 0.00024640535009680874, "line": "                    'must': must_parameters,"}, "270": {"hits": 143, "time": 0.00043773651123046875, "time_per_hit": 3.061094484129152e-06, "percent": 0.00030567582620117626, "line": "                    'must_not': must_not_parameters"}, "271": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "                },"}, "272": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            },"}, "273": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        }"}, "274": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "275": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        # Add optional parameters"}, "276": {"hits": 143, "time": 0.0003802776336669922, "time_per_hit": 2.6592841515174278e-06, "percent": 0.0002655517117597365, "line": "        if count:"}, "277": {"hits": 129, "time": 0.00024199485778808594, "time_per_hit": 1.875929130140201e-06, "percent": 0.0001689874529380141, "line": "            query['size'] = count"}, "278": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "279": {"hits": 143, "time": 0.0003857612609863281, "time_per_hit": 2.6976311957085884e-06, "percent": 0.000269380984092322, "line": "        if offset:"}, "280": {"hits": 116, "time": 0.000202178955078125, "time_per_hit": 1.7429220265355604e-06, "percent": 0.00014118360600141473, "line": "            query['from'] = offset"}, "281": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "282": {"hits": 143, "time": 0.0003666877746582031, "time_per_hit": 2.564250172434987e-06, "percent": 0.00025606177597898097, "line": "        if sort:"}, "283": {"hits": 129, "time": 0.0003046989440917969, "time_per_hit": 2.362007318541061e-06, "percent": 0.0002127743496106227, "line": "            query['sort'] = [{'@timestamp': {'order': 'desc', 'unmapped_type': 'string'}}]"}, "284": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "285": {"hits": 143, "time": 0.00038123130798339844, "time_per_hit": 2.665953202681108e-06, "percent": 0.0002662176721654035, "line": "        return query"}, "286": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "287": {"hits": 2, "time": 2.2411346435546875e-05, "time_per_hit": 1.1205673217773438e-05, "percent": 1.565006953317569e-05, "line": "    def _split_datetime_range(self, start_time, end_time, num_slices):"}, "288": {"hits": 1, "time": 2.1696090698242188e-05, "time_per_hit": 2.1696090698242188e-05, "percent": 1.5150599228925403e-05, "line": "        time_range = (end_time - start_time).total_seconds()"}, "289": {"hits": 1, "time": 1.2874603271484375e-05, "time_per_hit": 1.2874603271484375e-05, "percent": 8.990465476505183e-06, "line": "        if time_range <= 0:"}, "290": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "            raise Exception('Invalid start/end time range.')"}, "291": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "292": {"hits": 1, "time": 1.621246337890625e-05, "time_per_hit": 1.621246337890625e-05, "percent": 1.1321326896339862e-05, "line": "        slice_length = int(time_range / num_slices)"}, "293": {"hits": 16, "time": 0.00010442733764648438, "time_per_hit": 6.5267086029052734e-06, "percent": 7.292266442054205e-05, "line": "        return [start_time + datetime.timedelta(seconds=slice_length * i)"}, "294": {"hits": 14, "time": 0.00015878677368164062, "time_per_hit": 1.1341912405831473e-05, "percent": 0.00011088240754356393, "line": "                for i in range(num_slices)] + [end_time]"}, "295": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "296": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "#####################################################################"}, "297": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "298": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "299": {"hits": 2, "time": 1.0013580322265625e-05, "time_per_hit": 5.0067901611328125e-06, "percent": 6.992584259504032e-06, "line": "async def main():"}, "300": {"hits": 1, "time": 1.4543533325195312e-05, "time_per_hit": 1.4543533325195312e-05, "percent": 1.0155896186422522e-05, "line": "    arg_parser = common.get_arg_parser()"}, "301": {"hits": 1, "time": 2.1457672119140625e-06, "time_per_hit": 2.1457672119140625e-06, "percent": 1.4984109127508641e-06, "line": "    arg_parser.add_argument('-l', '--log', type=str, default='info',"}, "302": {"hits": 1, "time": 2.384185791015625e-06, "time_per_hit": 2.384185791015625e-06, "percent": 1.6649010141676268e-06, "line": "                            choices=['debug', 'info', 'warning', 'error'],"}, "303": {"hits": 1, "time": 7.3909759521484375e-06, "time_per_hit": 7.3909759521484375e-06, "percent": 5.161193143919642e-06, "line": "                            help='Log level')"}, "304": {"hits": 1, "time": 2.86102294921875e-06, "time_per_hit": 2.86102294921875e-06, "percent": 1.997881217001152e-06, "line": "    arg_parser.add_argument('-L', '--logfile', type=str,"}, "305": {"hits": 1, "time": 7.62939453125e-06, "time_per_hit": 7.62939453125e-06, "percent": 5.327683245336405e-06, "line": "                            help='Optional custom logfile name')"}, "306": {"hits": 1, "time": 1.0013580322265625e-05, "time_per_hit": 1.0013580322265625e-05, "percent": 6.992584259504032e-06, "line": "    args = arg_parser.parse_args()"}, "307": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "308": {"hits": 1, "time": 5.245208740234375e-06, "time_per_hit": 5.245208740234375e-06, "percent": 3.662782231168779e-06, "line": "    async with aiohttp.ClientSession("}, "309": {"hits": 1, "time": 4.0531158447265625e-06, "time_per_hit": 4.0531158447265625e-06, "percent": 2.8303317240849656e-06, "line": "        connector=aiohttp.TCPConnector("}, "310": {"hits": 1, "time": 5.0067901611328125e-06, "time_per_hit": 5.0067901611328125e-06, "percent": 3.496292129752016e-06, "line": "            ssl=False, family=socket.AF_INET,"}, "311": {"hits": 1, "time": 4.076957702636719e-05, "time_per_hit": 4.076957702636719e-05, "percent": 2.8469807342266416e-05, "line": "            limit=200, ttl_dns_cache=1000"}, "312": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        ),"}, "313": {"hits": 1, "time": 2.384185791015625e-06, "time_per_hit": 2.384185791015625e-06, "percent": 1.6649010141676268e-06, "line": "    ) as session:"}, "314": {"hits": 1, "time": 1.2636184692382812e-05, "time_per_hit": 1.2636184692382812e-05, "percent": 8.82397537508842e-06, "line": "        thing = Thingy(args.config, args.dataset, session, log_level=args.log, log_file=args.logfile)"}, "315": {"hits": 20, "time": 0.0004825592041015625, "time_per_hit": 2.4127960205078126e-05, "percent": 0.00033697596526752763, "line": "        await thing.run()"}, "316": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "317": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "318": {"hits": 1, "time": 6.67572021484375e-06, "time_per_hit": 6.67572021484375e-06, "percent": 4.661722839669354e-06, "line": "if __name__ == '__main__':"}, "319": {"hits": 1, "time": 2.3126602172851562e-05, "time_per_hit": 2.3126602172851562e-05, "percent": 1.614953983742598e-05, "line": "    loop = asyncio.get_event_loop()"}, "320": {"hits": 1, "time": 4.863739013671875e-05, "time_per_hit": 4.863739013671875e-05, "percent": 3.396398068901958e-05, "line": "    loop.run_until_complete(main())"}, "321": {"hits": 1, "time": 3.9577484130859375e-05, "time_per_hit": 3.9577484130859375e-05, "percent": 2.7637356835182604e-05, "line": "    loop.close()"}}, "util/progress_bar.py": {"file_total_time": 0.013068675994873047, "file_total_time_percent": 0.009125988419058428, "1": {"hits": 2, "time": 1.5735626220703125e-05, "time_per_hit": 7.867813110351562e-06, "percent": 1.0988346693506335e-05, "line": "import sys"}, "2": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "3": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "4": {"hits": 3, "time": 2.9325485229492188e-05, "time_per_hit": 9.775161743164062e-06, "percent": 2.047828247426181e-05, "line": "class ProgressBar(object):"}, "5": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "    \"\"\""}, "6": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "    An easy to use progress bar that will be printed to the terminal."}, "7": {"hits": 1, "time": 1.9073486328125e-06, "time_per_hit": 1.9073486328125e-06, "percent": 1.3319208113341012e-06, "line": "    \"\"\""}, "8": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "    # The number of '=' chars that make up the progress bar."}, "9": {"hits": 1, "time": 2.384185791015625e-06, "time_per_hit": 2.384185791015625e-06, "percent": 1.6649010141676268e-06, "line": "    PROGRESS_BAR_LENGTH = 20"}, "10": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "    # The percentage value per '=' char in the progress bar"}, "11": {"hits": 1, "time": 3.0994415283203125e-06, "time_per_hit": 3.0994415283203125e-06, "percent": 2.1643713184179145e-06, "line": "    PERCENTAGE_PER_CHAR = 100 / PROGRESS_BAR_LENGTH"}, "12": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "13": {"hits": 2, "time": 1.2159347534179688e-05, "time_per_hit": 6.079673767089844e-06, "percent": 8.490995172254895e-06, "line": "    def __init__(self, description):"}, "14": {"hits": 1, "time": 1.0728836059570312e-05, "time_per_hit": 1.0728836059570312e-05, "percent": 7.49205456375432e-06, "line": "        self._description = description"}, "15": {"hits": 1, "time": 1.0251998901367188e-05, "time_per_hit": 1.0251998901367188e-05, "percent": 7.159074360920795e-06, "line": "        self._extra_length = 0"}, "16": {"hits": 1, "time": 7.867813110351562e-06, "time_per_hit": 7.867813110351562e-06, "percent": 5.494173346753168e-06, "line": "        self._expected_steps = 1"}, "17": {"hits": 1, "time": 7.867813110351562e-06, "time_per_hit": 7.867813110351562e-06, "percent": 5.494173346753168e-06, "line": "        self._steps_completed = 0"}, "18": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "19": {"hits": 1, "time": 2.86102294921875e-06, "time_per_hit": 2.86102294921875e-06, "percent": 1.997881217001152e-06, "line": "    def reset(self):"}, "20": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "21": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        Resets progress bar to 0"}, "22": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "23": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        self._steps_completed = 0"}, "24": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "25": {"hits": 2, "time": 9.5367431640625e-06, "time_per_hit": 4.76837158203125e-06, "percent": 6.659604056670507e-06, "line": "    def set_steps(self, expected_steps):"}, "26": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "27": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        Sets the number of steps the process is expected to take."}, "28": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "29": {"hits": 1, "time": 7.62939453125e-06, "time_per_hit": 7.62939453125e-06, "percent": 5.327683245336405e-06, "line": "        self._expected_steps = expected_steps"}, "30": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "31": {"hits": 144, "time": 0.0002799034118652344, "time_per_hit": 1.9437736935085722e-06, "percent": 0.00019545937906327937, "line": "    def get_percentage(self, value, total):"}, "32": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "33": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        Returns the percentage value is of total in integer format."}, "34": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "35": {"hits": 143, "time": 0.0006406307220458984, "time_per_hit": 4.479935119202087e-06, "percent": 0.0004473589025068413, "line": "        return int((float(value)/total)*100) if total else 0"}, "36": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "37": {"hits": 145, "time": 0.0004165172576904297, "time_per_hit": 2.872532811658136e-06, "percent": 0.0002908582071750844, "line": "    def update(self, extra='', steps=1, done=False):"}, "38": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "39": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        Updates the progress bar displayed in the terminal."}, "40": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        :param extra: Optional extra info to include beside the progress bar."}, "41": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        :param done: If True, will update the progress bar to 100%"}, "42": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "43": {"hits": 144, "time": 0.0005662441253662109, "time_per_hit": 3.9322508705986874e-06, "percent": 0.0003954139908648113, "line": "        self._steps_completed += steps"}, "44": {"hits": 144, "time": 0.00029397010803222656, "time_per_hit": 2.041459083557129e-06, "percent": 0.00020528229504686838, "line": "        percent_done = 100 if done else self.get_percentage("}, "45": {"hits": 143, "time": 0.0009279251098632812, "time_per_hit": 6.488986782260708e-06, "percent": 0.0006479794747140403, "line": "            self._steps_completed, self._expected_steps)"}, "46": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "47": {"hits": 144, "time": 0.0010137557983398438, "time_per_hit": 7.039970821804471e-06, "percent": 0.0007079159112240749, "line": "        self._write(percent_done, extra)"}, "48": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "49": {"hits": 144, "time": 0.0002589225769042969, "time_per_hit": 1.798073450724284e-06, "percent": 0.00018080825013860427, "line": "        if done:"}, "50": {"hits": 1, "time": 1.5020370483398438e-05, "time_per_hit": 1.5020370483398438e-05, "percent": 1.0488876389256047e-05, "line": "            print(\"\\nDone!\")"}, "51": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "52": {"hits": 145, "time": 0.00031447410583496094, "time_per_hit": 2.168786936792834e-06, "percent": 0.00021960044376870996, "line": "    def _write(self, percent_done, extra):"}, "53": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "54": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        Writes the output string to the terminal."}, "55": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "56": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        :param percent_done: An integer percentage value"}, "57": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        :param extra: Optional extra info to include beside the progress bar."}, "58": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "59": {"hits": 144, "time": 0.00027060508728027344, "time_per_hit": 1.879201995001899e-06, "percent": 0.00018896626510802564, "line": "        output_string = '{}: {:3}% {} {}\\r'"}, "60": {"hits": 144, "time": 0.0008764266967773438, "time_per_hit": 6.086296505398221e-06, "percent": 0.0006120176128080196, "line": "        progress_bar = self._get_progress_bar(percent_done)"}, "61": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "62": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        # Add enough spaces to the extra to overwrite the previous extra"}, "63": {"hits": 144, "time": 0.0003077983856201172, "time_per_hit": 2.1374887890285918e-06, "percent": 0.0002149387209290406, "line": "        extra_length = len(extra)"}, "64": {"hits": 144, "time": 0.0004925727844238281, "time_per_hit": 3.420644336276584e-06, "percent": 0.0003439685495270317, "line": "        extra += ' ' * max(0, self._extra_length - extra_length)"}, "65": {"hits": 144, "time": 0.0002722740173339844, "time_per_hit": 1.8907917870415581e-06, "percent": 0.00019013169581794296, "line": "        self._extra_length = extra_length"}, "66": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "67": {"hits": 144, "time": 0.0004458427429199219, "time_per_hit": 3.096130159166124e-06, "percent": 0.0003113364896493462, "line": "        sys.stdout.write(output_string.format("}, "68": {"hits": 144, "time": 0.0031347274780273438, "time_per_hit": 2.1768940819634332e-05, "percent": 0.0021890118534275958, "line": "            self._description, percent_done, progress_bar, extra))"}, "69": {"hits": 144, "time": 0.0005354881286621094, "time_per_hit": 3.718667560153537e-06, "percent": 0.00037393676778204894, "line": "        sys.stdout.flush()"}, "70": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "71": {"hits": 145, "time": 0.0002574920654296875, "time_per_hit": 1.7758073477909482e-06, "percent": 0.00017980930953010368, "line": "    def _get_progress_bar(self, percentage):"}, "72": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "73": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        Returns a progress bar string with the given percentage completed."}, "74": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": ""}, "75": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        :param percentage: An integer value between 0 and 100"}, "76": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        :return: A progress bar string. ex. [==========          ]"}, "77": {"hits": 0, "time": 0, "time_per_hit": 0, "percent": 0.0, "line": "        \"\"\""}, "78": {"hits": 144, "time": 0.0002334117889404297, "time_per_hit": 1.620915200975206e-06, "percent": 0.00016299380928701065, "line": "        progress_bar = '[{:{length}}]'"}, "79": {"hits": 144, "time": 0.00026106834411621094, "time_per_hit": 1.8129746119181316e-06, "percent": 0.00018230666105135512, "line": "        return progress_bar.format("}, "80": {"hits": 144, "time": 0.0004067420959472656, "time_per_hit": 2.8245978885226778e-06, "percent": 0.0002840321130169971, "line": "            '=' * int(percentage / self.PERCENTAGE_PER_CHAR),"}, "81": {"hits": 144, "time": 0.0007255077362060547, "time_per_hit": 5.038248168097602e-06, "percent": 0.0005066293786112088, "line": "            length=self.PROGRESS_BAR_LENGTH)"}}};</script><script>!function(i){function e(e){for(var t,r,n=e[0],o=e[1],u=e[2],l=0,f=[];l<n.length;l++)r=n[l],Object.prototype.hasOwnProperty.call(p,r)&&p[r]&&f.push(p[r][0]),p[r]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(i[t]=o[t]);for(s&&s(e);f.length;)f.shift()();return c.push.apply(c,u||[]),a()}function a(){for(var e,t=0;t<c.length;t++){for(var r=c[t],n=!0,o=1;o<r.length;o++){var u=r[o];0!==p[u]&&(n=!1)}n&&(c.splice(t--,1),e=l(l.s=r[0]))}return e}var r={},p={1:0},c=[];function l(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,l),t.l=!0,t.exports}l.m=i,l.c=r,l.d=function(e,t,r){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(l.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)l.d(r,n,function(e){return t[e]}.bind(null,n));return r},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="./";var t=this.webpackJsonplgtm=this.webpackJsonplgtm||[],n=t.push.bind(t);t.push=e,t=t.slice();for(var o=0;o<t.length;o++)e(t[o]);var s=n;a()}([])</script><script src="./static/js/2.b1ca9f81.chunk.js"></script><script src="./static/js/main.c4e0d4a7.chunk.js"></script></body></html>