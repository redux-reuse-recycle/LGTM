(this.webpackJsonplgtm=this.webpackJsonplgtm||[]).push([[0],{277:function(e,t,i){},278:function(e,t,i){},279:function(e,t,i){},280:function(e,t,i){},33:function(e){e.exports=JSON.parse('{"total_time":143.20285534858704,"fetch_stuff.py":{"2":{"hits":2,"time":0.00005936622619628906,"time_per_hit":0.00002968311309814453,"percent":0.0000414560352527739,"line":"import asyncio"},"3":{"hits":1,"time":0.0000050067901611328125,"time_per_hit":0.0000050067901611328125,"percent":0.000003496292129752016,"line":"import datetime"},"4":{"hits":1,"time":0.00000762939453125,"time_per_hit":0.00000762939453125,"percent":0.000005327683245336405,"line":"import json"},"5":{"hits":1,"time":0.00000667572021484375,"time_per_hit":0.00000667572021484375,"percent":0.000004661722839669354,"line":"import logging"},"6":{"hits":1,"time":0.0000064373016357421875,"time_per_hit":0.0000064373016357421875,"percent":0.000004495232738252592,"line":"import os"},"7":{"hits":1,"time":0.0000064373016357421875,"time_per_hit":0.0000064373016357421875,"percent":0.000004495232738252592,"line":"import socket"},"8":{"hits":1,"time":0.000019788742065429688,"time_per_hit":0.000019788742065429688,"percent":0.000013818678417591302,"line":"from urllib.parse import urlparse"},"9":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"10":{"hits":1,"time":0.000028848648071289062,"time_per_hit":0.000028848648071289062,"percent":0.000020145302271428283,"line":"import aiofiles"},"11":{"hits":1,"time":0.000028371810913085938,"time_per_hit":0.000028371810913085938,"percent":0.000019812322068594758,"line":"import aiohttp"},"12":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"13":{"hits":1,"time":0.00003695487976074219,"time_per_hit":0.00003695487976074219,"percent":0.000025805965719598213,"line":"from util import common"},"14":{"hits":1,"time":0.0000400543212890625,"time_per_hit":0.0000400543212890625,"percent":0.00002797033703801613,"line":"from util.config import ConfigParser"},"15":{"hits":1,"time":0.00003838539123535156,"time_per_hit":0.00003838539123535156,"percent":0.00002680490632809879,"line":"from util.progress_bar import ProgressBar"},"16":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"17":{"hits":1,"time":0.000021219253540039062,"time_per_hit":0.000021219253540039062,"percent":0.000014817619026091878,"line":"logging.captureWarnings(True)"},"18":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"19":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"20":{"hits":3,"time":0.00005316734313964844,"time_per_hit":0.000017722447713216145,"percent":0.00003712729261593808,"line":"class Thingy(object):"},"21":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"22":{"hits":1,"time":0.00000286102294921875,"time_per_hit":0.00000286102294921875,"percent":0.000001997881217001152,"line":"    HTTP_PAGE_SIZE = 1000"},"23":{"hits":1,"time":0.000005245208740234375,"time_per_hit":0.000005245208740234375,"percent":0.000003662782231168779,"line":"    MAX_FILE_SIZE = 10000"},"24":{"hits":1,"time":0.000005245208740234375,"time_per_hit":0.000005245208740234375,"percent":0.000003662782231168779,"line":"    MAX_REQUEST_COUNT = 50"},"25":{"hits":1,"time":0.000005245208740234375,"time_per_hit":0.000005245208740234375,"percent":0.000003662782231168779,"line":"    MAX_RETRY_COUNT = 10"},"26":{"hits":1,"time":0.000005245208740234375,"time_per_hit":0.000005245208740234375,"percent":0.000003662782231168779,"line":"    REQUEST_BACKOFF_RATE = 0.5"},"27":{"hits":1,"time":0.000005245208740234375,"time_per_hit":0.000005245208740234375,"percent":0.000003662782231168779,"line":"    REQUEST_SLEEP_TIME = 10"},"28":{"hits":1,"time":0.00000476837158203125,"time_per_hit":0.00000476837158203125,"percent":0.0000033298020283352535,"line":"    REQUEST_TIMEOUT = 60"},"29":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"30":{"hits":2,"time":0.00000858306884765625,"time_per_hit":0.000004291534423828125,"percent":0.0000059936436510034565,"line":"    def __init__(self, config_file, data_set, session, log_level=\'info\', log_file=None):"},"31":{"hits":1,"time":0.00000286102294921875,"time_per_hit":0.00000286102294921875,"percent":0.000001997881217001152,"line":"        self._slice_tasks = []"},"32":{"hits":1,"time":0.0000026226043701171875,"time_per_hit":0.0000026226043701171875,"percent":0.0000018313911155843894,"line":"        self._progress_bar = None"},"33":{"hits":1,"time":0.000002384185791015625,"time_per_hit":0.000002384185791015625,"percent":0.0000016649010141676268,"line":"        self._session = session"},"34":{"hits":1,"time":0.000010728836059570312,"time_per_hit":0.000010728836059570312,"percent":0.00000749205456375432,"line":"        self._request_lock = asyncio.BoundedSemaphore(self.MAX_REQUEST_COUNT)"},"35":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"36":{"hits":1,"time":0.000011444091796875,"time_per_hit":0.000011444091796875,"percent":0.000007991524868004607,"line":"        self._config = ConfigParser(config_file)"},"37":{"hits":1,"time":0.0000035762786865234375,"time_per_hit":0.0000035762786865234375,"percent":0.00000249735152125144,"line":"        self._data_set = data_set"},"38":{"hits":1,"time":0.00000286102294921875,"time_per_hit":0.00000286102294921875,"percent":0.000001997881217001152,"line":"        data_set_config = self._config.data_sets[self._data_set]"},"39":{"hits":1,"time":0.0000040531158447265625,"time_per_hit":0.0000040531158447265625,"percent":0.0000028303317240849656,"line":"        self._data_set_start_time = datetime.datetime.strptime("},"40":{"hits":1,"time":0.00002384185791015625,"time_per_hit":0.00002384185791015625,"percent":0.000016649010141676266,"line":"            data_set_config[\'start_time\'], \'%Y-%m-%dT%H:%M:%S\')"},"41":{"hits":1,"time":0.0000040531158447265625,"time_per_hit":0.0000040531158447265625,"percent":0.0000028303317240849656,"line":"        self._data_set_end_time = datetime.datetime.strptime("},"42":{"hits":1,"time":0.000010728836059570312,"time_per_hit":0.000010728836059570312,"percent":0.00000749205456375432,"line":"            data_set_config[\'end_time\'], \'%Y-%m-%dT%H:%M:%S\')"},"43":{"hits":1,"time":0.0000045299530029296875,"time_per_hit":0.0000045299530029296875,"percent":0.000003163311926918491,"line":"        self._output_path = f\'{self._config.data_path}/{self._data_set}\'"},"44":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"45":{"hits":1,"time":0.000009298324584960938,"time_per_hit":0.000009298324584960938,"percent":0.0000064931139552537444,"line":"        if not os.path.exists(self._config.logging_path):"},"46":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            os.makedirs(self._config.logging_path)"},"47":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"48":{"hits":1,"time":0.000008344650268554688,"time_per_hit":0.000008344650268554688,"percent":0.000005827153549586694,"line":"        self._logger = logging.getLogger(__name__)"},"49":{"hits":1,"time":0.00000476837158203125,"time_per_hit":0.00000476837158203125,"percent":0.0000033298020283352535,"line":"        log_level = getattr(logging, log_level.upper())"},"50":{"hits":1,"time":0.00000762939453125,"time_per_hit":0.00000762939453125,"percent":0.000005327683245336405,"line":"        self._logger.setLevel(log_level)"},"51":{"hits":1,"time":0.000011444091796875,"time_per_hit":0.000011444091796875,"percent":0.000007991524868004607,"line":"        file_handler = logging.FileHandler(f\'{self._config.logging_path}/{log_file or self._data_set}.txt\')"},"52":{"hits":1,"time":0.0000095367431640625,"time_per_hit":0.0000095367431640625,"percent":0.000006659604056670507,"line":"        file_handler.setLevel(log_level)"},"53":{"hits":1,"time":0.0000073909759521484375,"time_per_hit":0.0000073909759521484375,"percent":0.000005161193143919642,"line":"        self._logger.addHandler(file_handler)"},"54":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"55":{"hits":1,"time":0.000003337860107421875,"time_per_hit":0.000003337860107421875,"percent":0.000002330861419834677,"line":"        env = data_set_config[\'filters\'][\'env\'].lower()"},"56":{"hits":1,"time":0.0000026226043701171875,"time_per_hit":0.0000026226043701171875,"percent":0.0000018313911155843894,"line":"        if env in [\'prod\', \'LT\']:"},"57":{"hits":1,"time":0.000010967254638671875,"time_per_hit":0.000010967254638671875,"percent":0.000007658544665171082,"line":"            parsed_url = urlparse(self._config.elasticsearch_config[\'prod_url\'])"},"58":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        else:"},"59":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            parsed_url = urlparse(self._config.elasticsearch_config[\'dev_url\'])"},"60":{"hits":1,"time":0.000016927719116210938,"time_per_hit":0.000016927719116210938,"percent":0.00001182079720059015,"line":"        self._host = parsed_url.hostname"},"61":{"hits":1,"time":0.0000073909759521484375,"time_per_hit":0.0000073909759521484375,"percent":0.000005161193143919642,"line":"        self._port = parsed_url.port"},"62":{"hits":1,"time":0.00000286102294921875,"time_per_hit":0.00000286102294921875,"percent":0.000001997881217001152,"line":"        self._filter = data_set_config[\'filters\']"},"63":{"hits":1,"time":0.0000030994415283203125,"time_per_hit":0.0000030994415283203125,"percent":0.0000021643713184179145,"line":"        self._query_parameters = data_set_config.get(\'query_parameters\', {})"},"64":{"hits":1,"time":0.0000026226043701171875,"time_per_hit":0.0000026226043701171875,"percent":0.0000018313911155843894,"line":"        self._schema = data_set_config[\'schema\']"},"65":{"hits":1,"time":0.000004291534423828125,"time_per_hit":0.000004291534423828125,"percent":0.0000029968218255017282,"line":"        self._auth = aiohttp.BasicAuth("},"66":{"hits":1,"time":0.00000286102294921875,"time_per_hit":0.00000286102294921875,"percent":0.000001997881217001152,"line":"            self._config.elasticsearch_config[\'user\'],"},"67":{"hits":1,"time":0.000009775161743164062,"time_per_hit":0.000009775161743164062,"percent":0.00000682609415808727,"line":"            self._config.elasticsearch_config[\'password\']"},"68":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        )"},"69":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"70":{"hits":2,"time":0.000016927719116210938,"time_per_hit":0.000008463859558105469,"percent":0.00001182079720059015,"line":"    def _progress_bar_init(self, total_records):"},"71":{"hits":1,"time":0.00003528594970703125,"time_per_hit":0.00003528594970703125,"percent":0.000024640535009680876,"line":"        self._progress_bar = ProgressBar(f\'Fetching {total_records} records\')"},"72":{"hits":1,"time":0.000027894973754882812,"time_per_hit":0.000027894973754882812,"percent":0.000019479341865761232,"line":"        self._progress_bar.set_steps(total_records * 2)"},"73":{"hits":1,"time":0.000032901763916015625,"time_per_hit":0.000032901763916015625,"percent":0.00002297563399551325,"line":"        self._progress_bar.update(steps=0)"},"74":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"75":{"hits":2,"time":0.0000095367431640625,"time_per_hit":0.00000476837158203125,"percent":0.000006659604056670507,"line":"    async def run(self):"},"76":{"hits":1,"time":0.000002384185791015625,"time_per_hit":0.000002384185791015625,"percent":0.0000016649010141676268,"line":"        total_records = await self._search("},"77":{"hits":6,"time":0.00019669532775878906,"time_per_hit":0.000032782554626464844,"percent":0.0001373543336688292,"line":"            self._data_set_start_time, self._data_set_end_time)"},"78":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"79":{"hits":1,"time":0.000009059906005859375,"time_per_hit":0.000009059906005859375,"percent":0.000006326623853836982,"line":"        if total_records == 0:"},"80":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            message = f\'No results found between {self._data_set_start_time} and {self._data_set_end_time}.\'"},"81":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            print(message)"},"82":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            self._logger.warning(message)"},"83":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            return 0"},"84":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"85":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        # Create output directory for the data"},"86":{"hits":1,"time":0.00003743171691894531,"time_per_hit":0.00003743171691894531,"percent":0.00002613894592243174,"line":"        if not os.path.exists(self._output_path):"},"87":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            self._logger.debug(f\'Creating output path: {self._output_path}\')"},"88":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            os.makedirs(self._output_path)"},"89":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"90":{"hits":1,"time":0.000034332275390625,"time_per_hit":0.000034332275390625,"percent":0.000023974574604013826,"line":"        self._progress_bar_init(total_records)"},"91":{"hits":1,"time":0.000011205673217773438,"time_per_hit":0.000011205673217773438,"percent":0.000007825034766587845,"line":"        await self._build_time_slices("},"92":{"hits":14,"time":0.0003180503845214844,"time_per_hit":0.000022717884608677457,"percent":0.0002220977952899614,"line":"            self._data_set_start_time, self._data_set_end_time, total_records)"},"93":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"94":{"hits":2,"time":0.00009226799011230469,"time_per_hit":0.000046133995056152344,"percent":0.00006443166924828715,"line":"        await asyncio.gather(*self._slice_tasks)"},"95":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"96":{"hits":1,"time":0.000021696090698242188,"time_per_hit":0.000021696090698242188,"percent":0.000015150599228925403,"line":"        self._progress_bar.update(done=True)"},"97":{"hits":1,"time":0.000005245208740234375,"time_per_hit":0.000005245208740234375,"percent":0.000003662782231168779,"line":"        return total_records"},"98":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"99":{"hits":2,"time":0.000018835067749023438,"time_per_hit":0.000009417533874511719,"percent":0.000013152718011924252,"line":"    async def _build_time_slices(self, start_time, end_time, num_results):"},"100":{"hits":1,"time":0.000011920928955078125,"time_per_hit":0.000011920928955078125,"percent":0.000008324505070838133,"line":"        if num_results > self.MAX_FILE_SIZE:"},"101":{"hits":1,"time":0.000035762786865234375,"time_per_hit":0.000035762786865234375,"percent":0.000024973515212514402,"line":"            self._logger.debug(f\'{num_results} larger than max file size {self.MAX_FILE_SIZE}\')"},"102":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"103":{"hits":1,"time":0.000016689300537109375,"time_per_hit":0.000016689300537109375,"percent":0.000011654307099173388,"line":"            num_slices = int(num_results / self.MAX_FILE_SIZE) + ("},"104":{"hits":1,"time":0.000013113021850585938,"time_per_hit":0.000013113021850585938,"percent":0.000009156955577921946,"line":"                num_results % self.MAX_FILE_SIZE != 0)"},"105":{"hits":1,"time":0.00004029273986816406,"time_per_hit":0.00004029273986816406,"percent":0.00002813682713943289,"line":"            self._logger.info(f\'Splitting time range into {num_slices} slices.\')"},"106":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"107":{"hits":1,"time":0.00004124641418457031,"time_per_hit":0.00004124641418457031,"percent":0.00002880278754509994,"line":"            time_ranges = self._split_datetime_range(start_time, end_time, num_slices)"},"108":{"hits":14,"time":0.00013828277587890625,"time_per_hit":0.00000987734113420759,"percent":0.00009656425882172235,"line":"            for i in range(1, len(time_ranges)):"},"109":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                # Since the number of logs per slice is not uniform,"},"110":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                # if we have more than 2 slices we need to check"},"111":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                # that each slice is still under the file size limit"},"112":{"hits":13,"time":0.00011467933654785156,"time_per_hit":0.000008821487426757812,"percent":0.00008008173878146284,"line":"                if num_slices > 2:"},"113":{"hits":26,"time":0.0013942718505859375,"time_per_hit":0.000053625840407151445,"percent":0.000973634113085228,"line":"                    num_logs = await self._search(time_ranges[i-1], time_ranges[i])"},"114":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                else:"},"115":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                    # The two slices probably won\'t be equal sized"},"116":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                    # but we can use this as a reasonable estimate"},"117":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                    # to avoid extra search requests"},"118":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                    num_logs = num_results / 2"},"119":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"120":{"hits":13,"time":0.0001552104949951172,"time_per_hit":0.000011939268845778246,"percent":0.0001083850560223125,"line":"                if num_logs < self.MAX_FILE_SIZE:"},"121":{"hits":13,"time":0.0008492469787597656,"time_per_hit":0.00006532669067382812,"percent":0.0005930377412465087,"line":"                    self._logger.debug(f\'Added slice {i} from {time_ranges[i-1]} to {time_ranges[i]}.\')"},"122":{"hits":13,"time":0.0001709461212158203,"time_per_hit":0.000013149701631986178,"percent":0.00011937340271581883,"line":"                    self._slice_tasks.append(self._run_slice("},"123":{"hits":13,"time":0.00017380714416503906,"time_per_hit":0.000013369780320387621,"percent":0.00012137128393281999,"line":"                        i, time_ranges[i-1], time_ranges[i]))"},"124":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                elif num_logs > 0:"},"125":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                    await self._build_time_slices(time_ranges[i-1], time_ranges[i], num_logs)"},"126":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        else:"},"127":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            self._slice_tasks.append(self._run_slice(1, start_time, end_time))"},"128":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"129":{"hits":15,"time":0.0001385211944580078,"time_per_hit":0.000009234746297200521,"percent":0.00009673074892313911,"line":"    async def _search(self, start_time, end_time):"},"130":{"hits":14,"time":0.0004911422729492188,"time_per_hit":0.000035081590924944195,"percent":0.0003429696089185311,"line":"        search_body = self._build_query_body(start_time, end_time)"},"131":{"hits":14,"time":0.0006163120269775391,"time_per_hit":0.00004402228764125279,"percent":0.0004303769121623315,"line":"        self._logger.debug(f\'Sending search request for time range {start_time} to {end_time}\')"},"132":{"hits":14,"time":0.00014901161193847656,"time_per_hit":0.000010643686567034041,"percent":0.00010405631338547666,"line":"        async with self._session.get("},"133":{"hits":14,"time":0.00016617774963378906,"time_per_hit":0.000011869839259556361,"percent":0.00011604360068748359,"line":"            f\'https://{self._host}:{self._port}/*:daily-*/_count\',"},"134":{"hits":14,"time":0.00011348724365234375,"time_per_hit":0.000008106231689453125,"percent":0.00007924928827437903,"line":"            json=search_body,"},"135":{"hits":14,"time":0.00011563301086425781,"time_per_hit":0.000008259500776018416,"percent":0.0000807476991871299,"line":"            auth=self._auth,"},"136":{"hits":32,"time":0.001287221908569336,"time_per_hit":0.00004022568464279175,"percent":0.0008988800575491017,"line":"            timeout=self.REQUEST_TIMEOUT"},"137":{"hits":14,"time":0.00015234947204589844,"time_per_hit":0.000010882105146135603,"percent":0.00010638717480531135,"line":"        ) as response:"},"138":{"hits":14,"time":0.00015115737915039062,"time_per_hit":0.00001079695565359933,"percent":0.00010555472429822753,"line":"            if response.status == 401:"},"139":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                message = f\'Elasticsearch request not authorized. \' \\\\"},"140":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                          f\'Check credentials in config file {self._config.config_file}\'"},"141":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                self._logger.error(message)"},"142":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                print(message)"},"143":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                return 0"},"144":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"145":{"hits":14,"time":0.0007305145263671875,"time_per_hit":0.00005217960902622768,"percent":0.0005101256707409608,"line":"            count_response = await response.json()"},"146":{"hits":14,"time":0.0008938312530517578,"time_per_hit":0.00006384508950369698,"percent":0.0006241713902114432,"line":"            self._logger.debug(f\'Got search response: {count_response}\')"},"147":{"hits":14,"time":0.0006117820739746094,"time_per_hit":0.000043698719569614953,"percent":0.000427213600235413,"line":"            return count_response[\'count\']"},"148":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"149":{"hits":14,"time":0.00003886222839355469,"time_per_hit":0.0000027758734566824776,"percent":0.000027137886530932315,"line":"    async def _run_slice(self, slice_num, start_time, end_time):"},"150":{"hits":5223,"time":0.05017518997192383,"time_per_hit":0.000009606584333127289,"percent":0.035037841843157704,"line":"        logs = await self._fetch(start_time, end_time)"},"151":{"hits":13,"time":0.00010919570922851562,"time_per_hit":0.000008399669940655049,"percent":0.0000762524664488773,"line":"        self._logger.debug(f\'Fetched {len(logs)} logs.\')"},"152":{"hits":52,"time":0.0829322338104248,"time_per_hit":0.001594850650200477,"percent":0.05791241634711098,"line":"        await self._write(logs, slice_num), slice_num"},"153":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"154":{"hits":14,"time":0.000051021575927734375,"time_per_hit":0.0000036443982805524555,"percent":0.00003562888170318721,"line":"    async def _fetch(self, start_time, end_time):"},"155":{"hits":13,"time":0.000056743621826171875,"time_per_hit":0.0000043648939866286055,"percent":0.000039624644137189516,"line":"        logs = []"},"156":{"hits":13,"time":0.0000457763671875,"time_per_hit":0.000003521259014423077,"percent":0.00003196609947201843,"line":"        offset = 0"},"157":{"hits":13,"time":0.00005269050598144531,"time_per_hit":0.0000040531158447265625,"percent":0.00003679431241310455,"line":"        keep_fetching = True"},"158":{"hits":142,"time":0.0003638267517089844,"time_per_hit":0.0000025621602233027067,"percent":0.00025406389476197985,"line":"        while keep_fetching:"},"159":{"hits":129,"time":0.0003216266632080078,"time_per_hit":0.000002493229947348898,"percent":0.00022459514681121283,"line":"            backoff = False"},"160":{"hits":129,"time":0.0002510547637939453,"time_per_hit":0.000001946160959642987,"percent":0.0001753140767918511,"line":"            fail_count = 0"},"161":{"hits":129,"time":0.0003247261047363281,"time_per_hit":0.0000025172566258630085,"percent":0.00022675951812963077,"line":"            query = self._build_query_body(start_time, end_time, self.HTTP_PAGE_SIZE,"},"162":{"hits":129,"time":0.0015912055969238281,"time_per_hit":0.000012334927107936653,"percent":0.001111154936855474,"line":"                                           offset, sort=True)"},"163":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"164":{"hits":130,"time":0.00036072731018066406,"time_per_hit":0.000002774825462928185,"percent":0.0002518995234435619,"line":"            while fail_count < self.MAX_RETRY_COUNT:"},"165":{"hits":130,"time":0.0008831024169921875,"time_per_hit":0.000006793095515324519,"percent":0.000616679335647689,"line":"                self._logger.debug(f\'Waiting for request lock...\')"},"166":{"hits":130,"time":0.0011105537414550781,"time_per_hit":0.000008542721088115985,"percent":0.0007755108923992805,"line":"                async with self._request_lock:"},"167":{"hits":130,"time":0.0008428096771240234,"time_per_hit":0.000006483151362492488,"percent":0.0005885425085082561,"line":"                    self._logger.debug(f\'Obtained request lock, sending fetch request...\')"},"168":{"hits":130,"time":0.0003101825714111328,"time_per_hit":0.000002386019780085637,"percent":0.00021660362194320822,"line":"                    try:"},"169":{"hits":130,"time":0.0003402233123779297,"time_per_hit":0.0000026171024029071515,"percent":0.00023758137472172032,"line":"                        async with self._session.get("},"170":{"hits":130,"time":0.0003955364227294922,"time_per_hit":0.00000304258786714994,"percent":0.0002762070782504093,"line":"                                f\'https://{self._host}:{self._port}/*:daily-*/_search\',"},"171":{"hits":130,"time":0.0002696514129638672,"time_per_hit":0.0000020742416381835936,"percent":0.00018830030470235858,"line":"                                json=query,"},"172":{"hits":130,"time":0.0002644062042236328,"time_per_hit":0.0000020338938786433293,"percent":0.0001846375224711898,"line":"                                auth=self._auth,"},"173":{"hits":320,"time":0.006619691848754883,"time_per_hit":0.00002068653702735901,"percent":0.0046225976658364155,"line":"                                timeout=self.REQUEST_TIMEOUT"},"174":{"hits":129,"time":0.005762338638305664,"time_per_hit":0.00004466929176981135,"percent":0.004023899261141737,"line":"                        ) as response:"},"175":{"hits":5150,"time":0.05323147773742676,"time_per_hit":0.000010336209269403254,"percent":0.03717207845321918,"line":"                            result = await response.json()"},"176":{"hits":129,"time":0.0029838085174560547,"time_per_hit":0.000023130298584930656,"percent":0.002083623619230785,"line":"                            self._logger.debug(f\'Got fetch response: {response}\')"},"177":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"178":{"hits":129,"time":0.00039458274841308594,"time_per_hit":0.0000030587809954502785,"percent":0.00027554111784474223,"line":"                            if result[\'_shards\'][\'failed\'] > 0:"},"179":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                self._logger.warning(f\'{result[\\"_shards\\"][\\"failed\\"]} request shards failed!\')"},"180":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                self._logger.warning(f\'Failure reason: {result[\\"_shards\\"][\\"failures\\"][0][\\"reason\\"]}\')"},"181":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"182":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                # If a request failed, it\'s most likely due to hitting the request queue size limit"},"183":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                if result[\'_shards\'][\'failures\'][0][\'reason\'][\'type\'] == \'es_rejected_execution_exception\':"},"184":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                    self._logger.warning(f\'Hit request queue limit.\')"},"185":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                    if backoff:"},"186":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                        # Second time we hit the request queue limit"},"187":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                        # Lower the number of simultaneous requests we\'re sending"},"188":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                        self.MAX_REQUEST_COUNT = max("},"189":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                            int(self.MAX_REQUEST_COUNT * self.REQUEST_BACKOFF_RATE), 1)"},"190":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                        self._logger.warning(f\'Max request count lowered to {self.MAX_REQUEST_COUNT}\')"},"191":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                    else:"},"192":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                        backoff = True"},"193":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                        # Try sleeping for a while to wait for the request queue to empty"},"194":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                        self._logger.debug(f\'Request sleeping for {self.REQUEST_SLEEP_TIME} seconds...\')"},"195":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                        await asyncio.sleep(self.REQUEST_SLEEP_TIME)"},"196":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"197":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                continue  # try again"},"198":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                            else:"},"199":{"hits":129,"time":0.0003211498260498047,"time_per_hit":0.000002489533535269804,"percent":0.0002242621666083793,"line":"                                results = result[\'hits\'][\'hits\']"},"200":{"hits":129,"time":0.00039839744567871094,"time_per_hit":0.0000030883522920830305,"percent":0.0002782049594674104,"line":"                                del result"},"201":{"hits":129,"time":0.0026502609252929688,"time_per_hit":0.00002054465833560441,"percent":0.0018507039673487339,"line":"                                logs.extend(results)"},"202":{"hits":129,"time":0.00043964385986328125,"time_per_hit":0.000003408091936924661,"percent":0.00030700774701251037,"line":"                                num_logs = len(results)"},"203":{"hits":129,"time":0.000530242919921875,"time_per_hit":0.000004110410231952519,"percent":0.0003702739855508802,"line":"                                del results"},"204":{"hits":129,"time":0.0012149810791015625,"time_per_hit":0.000009418457977531492,"percent":0.0008484335568198226,"line":"                                self._progress_bar.update(steps=num_logs)"},"205":{"hits":129,"time":0.0010607242584228516,"time_per_hit":0.000008222668669944586,"percent":0.0007407144612031771,"line":"                                self._logger.debug(f\'Fetched {num_logs} logs.\')"},"206":{"hits":129,"time":0.0003418922424316406,"time_per_hit":0.0000026503274607103925,"percent":0.00023874680543163767,"line":"                                offset += num_logs"},"207":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"208":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                                # If we didn\'t get a full page of logs, or we\'ve filled the file, we\'re done"},"209":{"hits":129,"time":0.0003867149353027344,"time_per_hit":0.0000029977901961452275,"percent":0.00027004694449798907,"line":"                                if num_logs != self.HTTP_PAGE_SIZE or offset == self.MAX_FILE_SIZE:"},"210":{"hits":13,"time":0.00003361701965332031,"time_per_hit":0.0000025859245887169472,"percent":0.000023475104299763536,"line":"                                    keep_fetching = False"},"211":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"212":{"hits":129,"time":0.002488374710083008,"time_per_hit":0.000019289726434752,"percent":0.001737657188486752,"line":"                                break  # done!"},"213":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"214":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                    # Sometimes get these errors, not sure why."},"215":{"hits":1,"time":0.0000045299530029296875,"time_per_hit":0.0000045299530029296875,"percent":0.000003163311926918491,"line":"                    except aiohttp.client_exceptions.ServerDisconnectedError:"},"216":{"hits":1,"time":0.0000030994415283203125,"time_per_hit":0.0000030994415283203125,"percent":0.0000021643713184179145,"line":"                        fail_count += 1"},"217":{"hits":1,"time":0.000022649765014648438,"time_per_hit":0.000022649765014648438,"percent":0.000015816559634592454,"line":"                        self._logger.error(f\'Got ServerDisconnectedError, increasing fail count to {fail_count}.\')"},"218":{"hits":13,"time":0.00003314018249511719,"time_per_hit":0.0000025492448073167066,"percent":0.00002314212409693001,"line":"        return logs"},"219":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"220":{"hits":14,"time":0.00005626678466796875,"time_per_hit":0.000004019056047712054,"percent":0.00003929166393435599,"line":"    async def _write(self, logs, slice_num):"},"221":{"hits":13,"time":0.000043392181396484375,"time_per_hit":0.000003337860107421875,"percent":0.000030301198457850807,"line":"        formatted_logs = []"},"222":{"hits":123152,"time":0.19799208641052246,"time_per_hit":0.000001607705002034254,"percent":0.13825987333043496,"line":"        while logs:"},"223":{"hits":123139,"time":0.39803290367126465,"time_per_hit":0.000003232387007132303,"percent":0.2779503961023442,"line":"            log = logs.pop()[\'_source\']"},"224":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"225":{"hits":123139,"time":0.2159428596496582,"time_per_hit":0.0000017536512368109063,"percent":0.15079507955620444,"line":"            log_dict = {}"},"226":{"hits":1108251,"time":1.814129114151001,"time_per_hit":0.0000016369298237953324,"percent":1.2668246800910599,"line":"            for field, _, _ in common.LOG_SCHEMAS[self._schema]:"},"227":{"hits":985112,"time":1.7247114181518555,"time_per_hit":0.0000017507769859182056,"percent":1.20438340000521,"line":"                field_levels = field.split(\'.\')"},"228":{"hits":985112,"time":1.6272215843200684,"time_per_hit":0.000001651813787995749,"percent":1.136305264555693,"line":"                if len(field_levels) > 1:"},"229":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                    log_data = log"},"230":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                    for nested_field in field_levels:"},"231":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                        log_data = log_data[nested_field]"},"232":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                    log_dict[field] = log_data"},"233":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                else:"},"234":{"hits":985112,"time":1.6699438095092773,"time_per_hit":0.000001695181674275897,"percent":1.1661386258285626,"line":"                    log_data = log[field]"},"235":{"hits":985112,"time":1.6000761985778809,"time_per_hit":0.0000016242581539742494,"percent":1.1173493675687862,"line":"                log_dict[field] = log_data"},"236":{"hits":123139,"time":0.2363910675048828,"time_per_hit":0.000001919709170164471,"percent":0.1650742695943145,"line":"            formatted_logs.append(log_dict)"},"237":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"238":{"hits":13,"time":0.00005459785461425781,"time_per_hit":0.000004199834970327524,"percent":0.00003812623322443865,"line":"        file_name = f\'{self._data_set}_{slice_num}\'"},"239":{"hits":13,"time":0.00004744529724121094,"time_per_hit":0.0000036496382493239184,"percent":0.000033131530181935774,"line":"        output_file = f\'{self._output_path}/{file_name}.json\'"},"240":{"hits":26,"time":0.0003616809844970703,"time_per_hit":0.000013910807096041166,"percent":0.00025256548384922897,"line":"        async with aiofiles.open(output_file, \'w\') as outfile:"},"241":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            # Indent is set to 0 to reduce file size"},"242":{"hits":13,"time":0.00032901763916015625,"time_per_hit":0.000025309049166165867,"percent":0.00022975633995513247,"line":"            json_logs = json.dumps(formatted_logs, indent=0, sort_keys=True)"},"243":{"hits":13,"time":0.00021386146545410156,"time_per_hit":0.000016450881958007812,"percent":0.0001493416209708361,"line":"            self._logger.debug(f\'Writing {len(json_logs)} logs to file {output_file}.\')"},"244":{"hits":39,"time":0.0005407333374023438,"time_per_hit":0.000013864957369290865,"percent":0.00037759955001321775,"line":"            await outfile.write(json_logs)"},"245":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"246":{"hits":13,"time":0.0001385211944580078,"time_per_hit":0.000010655476496769832,"percent":0.00009673074892313911,"line":"        self._progress_bar.update(steps=len(formatted_logs))"},"247":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"248":{"hits":144,"time":0.0007061958312988281,"time_per_hit":0.000004904137717352973,"percent":0.000493143680396451,"line":"    def _build_query_body(self, start_time, end_time, count=None, offset=None, sort=False):"},"249":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        filters = ["},"250":{"hits":143,"time":0.001622915267944336,"time_per_hit":0.000011349057817792559,"percent":0.0011332981203439035,"line":"            {\'range\': {\'@timestamp\': {\'gte\': start_time.isoformat(), \'lt\': end_time.isoformat()}}}]"},"251":{"hits":572,"time":0.002017498016357422,"time_per_hit":0.000003527094434191297,"percent":0.0014088392381886457,"line":"        for filter_term, filter_value in self._filter.items():"},"252":{"hits":429,"time":0.0012655258178710938,"time_per_hit":0.000002949943631401151,"percent":0.0008837294583201763,"line":"            if filter_term == \'env\':"},"253":{"hits":143,"time":0.0005495548248291016,"time_per_hit":0.000003843040733070641,"percent":0.0003837596837656379,"line":"                filters.append({\'term\': {filter_term: filter_value.upper()}})"},"254":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            else:"},"255":{"hits":286,"time":0.0010144710540771484,"time_per_hit":0.0000035471015876823374,"percent":0.0007084153815283252,"line":"                filters.append({\'term\': {filter_term: filter_value}})"},"256":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"257":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        # Build query parameters"},"258":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        must_parameters = ["},"259":{"hits":572,"time":0.0014903545379638672,"time_per_hit":0.0000026055149265102573,"percent":0.0010407296239561834,"line":"            {\'match_phrase\': {\'message\': parameter}}"},"260":{"hits":286,"time":0.001833200454711914,"time_per_hit":0.000006409791799692007,"percent":0.0012801423897934882,"line":"            for parameter in self._query_parameters.get(\'must\', [])]"},"261":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        must_not_parameters = ["},"262":{"hits":572,"time":0.0013437271118164062,"time_per_hit":0.0000023491732724063047,"percent":0.0009383382115848744,"line":"            {\'match_phrase\': {\'message\': parameter}}"},"263":{"hits":286,"time":0.0015692710876464844,"time_per_hit":0.000005486961844917777,"percent":0.0010958378475251318,"line":"            for parameter in self._query_parameters.get(\'must_not\', [])]"},"264":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"265":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        query = {"},"266":{"hits":143,"time":0.0003924369812011719,"time_per_hit":0.0000027443145538543487,"percent":0.00027404270693199136,"line":"            \'query\': {"},"267":{"hits":143,"time":0.00036215782165527344,"time_per_hit":0.0000025325721794075064,"percent":0.0002528984640520625,"line":"                \'bool\': {"},"268":{"hits":143,"time":0.0003559589385986328,"time_per_hit":0.000002489223346843586,"percent":0.0002485697214152267,"line":"                    \'filter\': filters,"},"269":{"hits":143,"time":0.0003528594970703125,"time_per_hit":0.000002467548930561626,"percent":0.00024640535009680874,"line":"                    \'must\': must_parameters,"},"270":{"hits":143,"time":0.00043773651123046875,"time_per_hit":0.000003061094484129152,"percent":0.00030567582620117626,"line":"                    \'must_not\': must_not_parameters"},"271":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"                },"},"272":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            },"},"273":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        }"},"274":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"275":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        # Add optional parameters"},"276":{"hits":143,"time":0.0003802776336669922,"time_per_hit":0.0000026592841515174278,"percent":0.0002655517117597365,"line":"        if count:"},"277":{"hits":129,"time":0.00024199485778808594,"time_per_hit":0.000001875929130140201,"percent":0.0001689874529380141,"line":"            query[\'size\'] = count"},"278":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"279":{"hits":143,"time":0.0003857612609863281,"time_per_hit":0.0000026976311957085884,"percent":0.000269380984092322,"line":"        if offset:"},"280":{"hits":116,"time":0.000202178955078125,"time_per_hit":0.0000017429220265355604,"percent":0.00014118360600141473,"line":"            query[\'from\'] = offset"},"281":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"282":{"hits":143,"time":0.0003666877746582031,"time_per_hit":0.000002564250172434987,"percent":0.00025606177597898097,"line":"        if sort:"},"283":{"hits":129,"time":0.0003046989440917969,"time_per_hit":0.000002362007318541061,"percent":0.0002127743496106227,"line":"            query[\'sort\'] = [{\'@timestamp\': {\'order\': \'desc\', \'unmapped_type\': \'string\'}}]"},"284":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"285":{"hits":143,"time":0.00038123130798339844,"time_per_hit":0.000002665953202681108,"percent":0.0002662176721654035,"line":"        return query"},"286":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"287":{"hits":2,"time":0.000022411346435546875,"time_per_hit":0.000011205673217773438,"percent":0.00001565006953317569,"line":"    def _split_datetime_range(self, start_time, end_time, num_slices):"},"288":{"hits":1,"time":0.000021696090698242188,"time_per_hit":0.000021696090698242188,"percent":0.000015150599228925403,"line":"        time_range = (end_time - start_time).total_seconds()"},"289":{"hits":1,"time":0.000012874603271484375,"time_per_hit":0.000012874603271484375,"percent":0.000008990465476505183,"line":"        if time_range <= 0:"},"290":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"            raise Exception(\'Invalid start/end time range.\')"},"291":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"292":{"hits":1,"time":0.00001621246337890625,"time_per_hit":0.00001621246337890625,"percent":0.000011321326896339862,"line":"        slice_length = int(time_range / num_slices)"},"293":{"hits":16,"time":0.00010442733764648438,"time_per_hit":0.0000065267086029052734,"percent":0.00007292266442054205,"line":"        return [start_time + datetime.timedelta(seconds=slice_length * i)"},"294":{"hits":14,"time":0.00015878677368164062,"time_per_hit":0.000011341912405831473,"percent":0.00011088240754356393,"line":"                for i in range(num_slices)] + [end_time]"},"295":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"296":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"#####################################################################"},"297":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"298":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"299":{"hits":2,"time":0.000010013580322265625,"time_per_hit":0.0000050067901611328125,"percent":0.000006992584259504032,"line":"async def main():"},"300":{"hits":1,"time":0.000014543533325195312,"time_per_hit":0.000014543533325195312,"percent":0.000010155896186422522,"line":"    arg_parser = common.get_arg_parser()"},"301":{"hits":1,"time":0.0000021457672119140625,"time_per_hit":0.0000021457672119140625,"percent":0.0000014984109127508641,"line":"    arg_parser.add_argument(\'-l\', \'--log\', type=str, default=\'info\',"},"302":{"hits":1,"time":0.000002384185791015625,"time_per_hit":0.000002384185791015625,"percent":0.0000016649010141676268,"line":"                            choices=[\'debug\', \'info\', \'warning\', \'error\'],"},"303":{"hits":1,"time":0.0000073909759521484375,"time_per_hit":0.0000073909759521484375,"percent":0.000005161193143919642,"line":"                            help=\'Log level\')"},"304":{"hits":1,"time":0.00000286102294921875,"time_per_hit":0.00000286102294921875,"percent":0.000001997881217001152,"line":"    arg_parser.add_argument(\'-L\', \'--logfile\', type=str,"},"305":{"hits":1,"time":0.00000762939453125,"time_per_hit":0.00000762939453125,"percent":0.000005327683245336405,"line":"                            help=\'Optional custom logfile name\')"},"306":{"hits":1,"time":0.000010013580322265625,"time_per_hit":0.000010013580322265625,"percent":0.000006992584259504032,"line":"    args = arg_parser.parse_args()"},"307":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"308":{"hits":1,"time":0.000005245208740234375,"time_per_hit":0.000005245208740234375,"percent":0.000003662782231168779,"line":"    async with aiohttp.ClientSession("},"309":{"hits":1,"time":0.0000040531158447265625,"time_per_hit":0.0000040531158447265625,"percent":0.0000028303317240849656,"line":"        connector=aiohttp.TCPConnector("},"310":{"hits":1,"time":0.0000050067901611328125,"time_per_hit":0.0000050067901611328125,"percent":0.000003496292129752016,"line":"            ssl=False, family=socket.AF_INET,"},"311":{"hits":1,"time":0.00004076957702636719,"time_per_hit":0.00004076957702636719,"percent":0.000028469807342266416,"line":"            limit=200, ttl_dns_cache=1000"},"312":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        ),"},"313":{"hits":1,"time":0.000002384185791015625,"time_per_hit":0.000002384185791015625,"percent":0.0000016649010141676268,"line":"    ) as session:"},"314":{"hits":1,"time":0.000012636184692382812,"time_per_hit":0.000012636184692382812,"percent":0.00000882397537508842,"line":"        thing = Thingy(args.config, args.dataset, session, log_level=args.log, log_file=args.logfile)"},"315":{"hits":20,"time":0.0004825592041015625,"time_per_hit":0.000024127960205078126,"percent":0.00033697596526752763,"line":"        await thing.run()"},"316":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"317":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"318":{"hits":1,"time":0.00000667572021484375,"time_per_hit":0.00000667572021484375,"percent":0.000004661722839669354,"line":"if __name__ == \'__main__\':"},"319":{"hits":1,"time":0.000023126602172851562,"time_per_hit":0.000023126602172851562,"percent":0.00001614953983742598,"line":"    loop = asyncio.get_event_loop()"},"320":{"hits":1,"time":0.00004863739013671875,"time_per_hit":0.00004863739013671875,"percent":0.00003396398068901958,"line":"    loop.run_until_complete(main())"},"321":{"hits":1,"time":0.000039577484130859375,"time_per_hit":0.000039577484130859375,"percent":0.000027637356835182604,"line":"    loop.close()"},"file_total_time":9.735131978988647,"file_total_time_percent":6.798140969529699},"util/progress_bar.py":{"1":{"hits":2,"time":0.000015735626220703125,"time_per_hit":0.000007867813110351562,"percent":0.000010988346693506335,"line":"import sys"},"2":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"3":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"4":{"hits":3,"time":0.000029325485229492188,"time_per_hit":0.000009775161743164062,"percent":0.00002047828247426181,"line":"class ProgressBar(object):"},"5":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"    \\"\\"\\""},"6":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"    An easy to use progress bar that will be printed to the terminal."},"7":{"hits":1,"time":0.0000019073486328125,"time_per_hit":0.0000019073486328125,"percent":0.0000013319208113341012,"line":"    \\"\\"\\""},"8":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"    # The number of \'=\' chars that make up the progress bar."},"9":{"hits":1,"time":0.000002384185791015625,"time_per_hit":0.000002384185791015625,"percent":0.0000016649010141676268,"line":"    PROGRESS_BAR_LENGTH = 20"},"10":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"    # The percentage value per \'=\' char in the progress bar"},"11":{"hits":1,"time":0.0000030994415283203125,"time_per_hit":0.0000030994415283203125,"percent":0.0000021643713184179145,"line":"    PERCENTAGE_PER_CHAR = 100 / PROGRESS_BAR_LENGTH"},"12":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"13":{"hits":2,"time":0.000012159347534179688,"time_per_hit":0.000006079673767089844,"percent":0.000008490995172254895,"line":"    def __init__(self, description):"},"14":{"hits":1,"time":0.000010728836059570312,"time_per_hit":0.000010728836059570312,"percent":0.00000749205456375432,"line":"        self._description = description"},"15":{"hits":1,"time":0.000010251998901367188,"time_per_hit":0.000010251998901367188,"percent":0.000007159074360920795,"line":"        self._extra_length = 0"},"16":{"hits":1,"time":0.000007867813110351562,"time_per_hit":0.000007867813110351562,"percent":0.000005494173346753168,"line":"        self._expected_steps = 1"},"17":{"hits":1,"time":0.000007867813110351562,"time_per_hit":0.000007867813110351562,"percent":0.000005494173346753168,"line":"        self._steps_completed = 0"},"18":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"19":{"hits":1,"time":0.00000286102294921875,"time_per_hit":0.00000286102294921875,"percent":0.000001997881217001152,"line":"    def reset(self):"},"20":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"21":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        Resets progress bar to 0"},"22":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"23":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        self._steps_completed = 0"},"24":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"25":{"hits":2,"time":0.0000095367431640625,"time_per_hit":0.00000476837158203125,"percent":0.000006659604056670507,"line":"    def set_steps(self, expected_steps):"},"26":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"27":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        Sets the number of steps the process is expected to take."},"28":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"29":{"hits":1,"time":0.00000762939453125,"time_per_hit":0.00000762939453125,"percent":0.000005327683245336405,"line":"        self._expected_steps = expected_steps"},"30":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"31":{"hits":144,"time":0.0002799034118652344,"time_per_hit":0.0000019437736935085722,"percent":0.00019545937906327937,"line":"    def get_percentage(self, value, total):"},"32":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"33":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        Returns the percentage value is of total in integer format."},"34":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"35":{"hits":143,"time":0.0006406307220458984,"time_per_hit":0.000004479935119202087,"percent":0.0004473589025068413,"line":"        return int((float(value)/total)*100) if total else 0"},"36":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"37":{"hits":145,"time":0.0004165172576904297,"time_per_hit":0.000002872532811658136,"percent":0.0002908582071750844,"line":"    def update(self, extra=\'\', steps=1, done=False):"},"38":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"39":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        Updates the progress bar displayed in the terminal."},"40":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        :param extra: Optional extra info to include beside the progress bar."},"41":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        :param done: If True, will update the progress bar to 100%"},"42":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"43":{"hits":144,"time":0.0005662441253662109,"time_per_hit":0.0000039322508705986874,"percent":0.0003954139908648113,"line":"        self._steps_completed += steps"},"44":{"hits":144,"time":0.00029397010803222656,"time_per_hit":0.000002041459083557129,"percent":0.00020528229504686838,"line":"        percent_done = 100 if done else self.get_percentage("},"45":{"hits":143,"time":0.0009279251098632812,"time_per_hit":0.000006488986782260708,"percent":0.0006479794747140403,"line":"            self._steps_completed, self._expected_steps)"},"46":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"47":{"hits":144,"time":0.0010137557983398438,"time_per_hit":0.000007039970821804471,"percent":0.0007079159112240749,"line":"        self._write(percent_done, extra)"},"48":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"49":{"hits":144,"time":0.0002589225769042969,"time_per_hit":0.000001798073450724284,"percent":0.00018080825013860427,"line":"        if done:"},"50":{"hits":1,"time":0.000015020370483398438,"time_per_hit":0.000015020370483398438,"percent":0.000010488876389256047,"line":"            print(\\"\\\\nDone!\\")"},"51":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"52":{"hits":145,"time":0.00031447410583496094,"time_per_hit":0.000002168786936792834,"percent":0.00021960044376870996,"line":"    def _write(self, percent_done, extra):"},"53":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"54":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        Writes the output string to the terminal."},"55":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"56":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        :param percent_done: An integer percentage value"},"57":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        :param extra: Optional extra info to include beside the progress bar."},"58":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"59":{"hits":144,"time":0.00027060508728027344,"time_per_hit":0.000001879201995001899,"percent":0.00018896626510802564,"line":"        output_string = \'{}: {:3}% {} {}\\\\r\'"},"60":{"hits":144,"time":0.0008764266967773438,"time_per_hit":0.000006086296505398221,"percent":0.0006120176128080196,"line":"        progress_bar = self._get_progress_bar(percent_done)"},"61":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"62":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        # Add enough spaces to the extra to overwrite the previous extra"},"63":{"hits":144,"time":0.0003077983856201172,"time_per_hit":0.0000021374887890285918,"percent":0.0002149387209290406,"line":"        extra_length = len(extra)"},"64":{"hits":144,"time":0.0004925727844238281,"time_per_hit":0.000003420644336276584,"percent":0.0003439685495270317,"line":"        extra += \' \' * max(0, self._extra_length - extra_length)"},"65":{"hits":144,"time":0.0002722740173339844,"time_per_hit":0.0000018907917870415581,"percent":0.00019013169581794296,"line":"        self._extra_length = extra_length"},"66":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"67":{"hits":144,"time":0.0004458427429199219,"time_per_hit":0.000003096130159166124,"percent":0.0003113364896493462,"line":"        sys.stdout.write(output_string.format("},"68":{"hits":144,"time":0.0031347274780273438,"time_per_hit":0.000021768940819634332,"percent":0.0021890118534275958,"line":"            self._description, percent_done, progress_bar, extra))"},"69":{"hits":144,"time":0.0005354881286621094,"time_per_hit":0.000003718667560153537,"percent":0.00037393676778204894,"line":"        sys.stdout.flush()"},"70":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"71":{"hits":145,"time":0.0002574920654296875,"time_per_hit":0.0000017758073477909482,"percent":0.00017980930953010368,"line":"    def _get_progress_bar(self, percentage):"},"72":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"73":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        Returns a progress bar string with the given percentage completed."},"74":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":""},"75":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        :param percentage: An integer value between 0 and 100"},"76":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        :return: A progress bar string. ex. [==========          ]"},"77":{"hits":0,"time":0,"time_per_hit":0,"percent":0,"line":"        \\"\\"\\""},"78":{"hits":144,"time":0.0002334117889404297,"time_per_hit":0.000001620915200975206,"percent":0.00016299380928701065,"line":"        progress_bar = \'[{:{length}}]\'"},"79":{"hits":144,"time":0.00026106834411621094,"time_per_hit":0.0000018129746119181316,"percent":0.00018230666105135512,"line":"        return progress_bar.format("},"80":{"hits":144,"time":0.0004067420959472656,"time_per_hit":0.0000028245978885226778,"percent":0.0002840321130169971,"line":"            \'=\' * int(percentage / self.PERCENTAGE_PER_CHAR),"},"81":{"hits":144,"time":0.0007255077362060547,"time_per_hit":0.000005038248168097602,"percent":0.0005066293786112088,"line":"            length=self.PROGRESS_BAR_LENGTH)"},"file_total_time":0.013068675994873047,"file_total_time_percent":0.009125988419058428}}')},57:function(e,t,i){"use strict";var r=i(0),n=i.n(r),_=i(5),s=function(e){var t=e.symbol,i=e.name;return n.a.createElement("span",{role:"img","aria-label":"".concat(i," Emoji")},t)},m=function(){return n.a.createElement(s,{symbol:"\u2764\ufe0f",name:"Heart"})},l=(i(68),function(){return n.a.createElement("div",{className:"HeaderContainer"},n.a.createElement(_.b,{to:"/"},n.a.createElement("div",{className:"HeaderTitle"},"LHTM Python Profiler")),n.a.createElement("div",{className:"HeaderSubtitle"},"Made with ",n.a.createElement(m,null)))}),p=(i(73),function(){return n.a.createElement("div",{className:"FooterContainer"},n.a.createElement("div",{className:"FooterText"},"Made for CPSC 410"))}),h=i(2),c=(i(74),function(e){var t=e.children;return n.a.createElement("div",{className:"HomeContainer"},n.a.createElement("div",null,t))}),a=i(8),o=i(29),f=i.n(o),u=i(48),g=i(33),d=function(){var e=Object(u.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.line_level_profile){e.next=2;break}return e.abrupt("return",window.line_level_profile);case 2:return e.abrupt("return",g);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=i(58),b=function(e){var t=e.Child,i=n.a.useState(!1),r=Object(a.a)(i,2),_=r[0],s=r[1],m=n.a.useState([]),l=Object(a.a)(m,2),p=l[0],h=l[1];return n.a.useEffect((function(){d().then((function(e){return function(e){return Object.entries(e).filter((function(e){var t=Object(a.a)(e,2),i=t[0];t[1];return"total_time"!==i})).map((function(e){var t,i=Object(a.a)(e,2),r=i[0],n=i[1],_=n.file_total_time,s=n.file_total_time_percent,m=Object(E.a)(n,["file_total_time","file_total_time_percent"]);return{name:r,totalTime:_,totalTimePercent:s,lines:(t=Object.entries(m),t.map((function(e){var t=Object(a.a)(e,2),i=t[0],r=t[1],n=r.hits,_=r.time,s=r.percent;return{lineNumber:i,hits:n,time:_,timePerHit:r.time_per_hit,percent:s,lineText:r.line}})))}}))}(e)})).then((function(e){return h(e)})).then((function(){return s(!0)}))}),[]),n.a.createElement(t,{isLoaded:_,fileList:p})},v=(i(76),function(e){var t=e.files;return n.a.createElement("div",{className:"FileListContainer"},n.a.createElement("div",{className:"FileListTitle"},"Project Files"),n.a.createElement("div",{className:"FileList"},t.map((function(e){return n.a.createElement(_.b,{to:"/file/".concat(btoa(e.name))},n.a.createElement("div",{className:"FileListItem",key:e.name}," ",e.name," "))}))))}),w=function(){return n.a.createElement(s,{symbol:"\ud83e\udd13",name:"Heart"})},T=(i(77),function(){return n.a.createElement("div",{className:"Spinner"},n.a.createElement(w,null))}),y=function(){return n.a.createElement(b,{Child:function(e){var t=e.isLoaded,i=e.fileList;return t?n.a.createElement(v,{files:i}):n.a.createElement(T,null)}})},S=function(){return n.a.createElement(c,null,n.a.createElement(y,null))},x=i(49),N=i(50),C=i(283);i(78);function L(){var e=Object(x.a)(["\n        code:nth-of-type(2) {\n          ","\n        }\n   "]);return L=function(){return e},e}var O=function(e){var t=e.file,i=e.view,_=Object(r.useMemo)((function(){return t.lines.map((function(e){return e.lineText})).join("\n")}),[t]),s=Object(r.useMemo)((function(){return t.lines.slice().sort((function(e,t){return t.hits-e.hits}))}),[t]),m=Object(r.useMemo)((function(){return t.lines.slice().sort((function(e,t){return t.time-e.time}))}),[t]),l=Object(r.useMemo)((function(){return s&&s[0]&&s[0].hits||0}),[t]),p=Object(r.useMemo)((function(){return m&&m[0]&&m[0].time||0}),[t]),h=function(e){if("hits"===i){var r=t.lines&&t.lines[e-1]&&t.lines[e-1].hits||0;return 0===r?0:r/l}if("time"===i){var n=t.lines&&t.lines[e-1]&&t.lines[e-1].time||0;return 0===n?0:n/p}return 0},c=Object(N.a)(C.a)(L(),function(){for(var e="",r=1;r<=t.lines.length;r++){var n=h(r);e+="\n                    span:nth-of-type(".concat(r,") {\n                        background-color: ").concat("hits"===i?"rgba(0,0,180, ".concat(n?Math.max(n/2.5,.05):0,")"):"rgba(255,".concat(255*(1-n),",0, ").concat(n>.5?.5:n,")"),";\n                        display: block;\n                        text-shadow: none !important;\n                        span {\n                            display: initial;\n                            background-color: initial;\n                        }\n                    }\n                ")}return e}());return n.a.createElement("div",{className:"CodeViewerContainer"},n.a.createElement(c,{language:"python",showLineNumbers:!0,wrapLines:!0,startingLineNumber:parseInt(t.lines[0].lineNumber)},_))},A=(i(277),function(e){var t=e.fileList,i=e.isLoaded,r=e.view,_=Object(h.g)().fileName;_=atob(_);var s=t.find((function(e){return e.name===_}));return _&&s||!i?n.a.createElement(O,{file:s,view:r}):n.a.createElement(h.a,{to:"/"})}),I=i(12),q=i.n(I),R=(i(278),function(e){var t=e.view,i=e.setView,r=e.fileList,s=Object(h.g)().fileName;s=atob(s);var m=r.find((function(e){return e.name===s}));return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"ViewToggleTop"},n.a.createElement("div",null,m&&m.name),n.a.createElement(_.b,{to:"/"},n.a.createElement("div",{className:"ViewAllFiles"},"View All Files"))),n.a.createElement("div",{className:"ViewToggleContainer"},n.a.createElement("div",{className:q()("ViewToggleItem",{"ViewToggleItem--Selected":"hits"===t}),onClick:function(){return i("hits")}},"Hits"),n.a.createElement("div",{className:q()("ViewToggleItem",{"ViewToggleItem--Selected":"time"===t}),onClick:function(){return i("time")}},"Time"),n.a.createElement("div",{className:q()("ViewToggleItem",{"ViewToggleItem--Selected":"none"===t}),onClick:function(){return i("none")}},"None")))}),j=(i(279),function(e){var t=e.fileList,i=e.view,r=Object(h.g)().fileName;r=atob(r);var _=t.find((function(e){return e.name===r})),s=_.lines.slice().sort((function(e,t){return t.hits-e.hits}))[0].hits,m=_.lines.slice().sort((function(e,t){return t.time-e.time}))[0].time,l=0;return"hits"===i&&(l=s),"time"===i&&(l=m),"none"===i?null:n.a.createElement("div",{className:"GradientContainer"},n.a.createElement("div",{className:q()("GradientColour",{"GradientColour--blue":"hits"===i,"GradientColour--red":"time"===i})}),n.a.createElement("div",{className:"GradientTextContainer"},n.a.createElement("div",{className:"GradientTextItem"},"0"),n.a.createElement("div",{className:"GradientTextItem"},l)))}),k=function(){var e=Object(r.useState)("hits"),t=Object(a.a)(e,2),i=t[0],_=t[1];return n.a.createElement("div",null,n.a.createElement(b,{Child:function(e){var t=e.fileList;return e.isLoaded?n.a.createElement(n.a.Fragment,null,n.a.createElement(R,{fileList:t,setView:_,view:i}),n.a.createElement(j,{fileList:t,view:i}),n.a.createElement(A,{fileList:t,view:i})):n.a.createElement(T,null)}}))},F=function(){return n.a.createElement(h.d,null,n.a.createElement(h.b,{path:"/",exact:!0,component:S}),n.a.createElement(h.b,{path:"/file/:fileName",component:k}),n.a.createElement(h.a,{to:"/"}))};i(280),t.a=function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(l,null),n.a.createElement(F,null),n.a.createElement(p,null))}},61:function(e,t,i){e.exports=i(62)},62:function(e,t,i){"use strict";i.r(t),function(e){var t=i(0),r=i.n(t),n=i(45),_=i.n(n),s=(i(67),i(57)),m=i(26),l=i.n(m),p=i(5),h=i(56);i.n(h).a.config({path:l.a.resolve(e,"../.env")}),_.a.render(r.a.createElement(p.a,null,r.a.createElement(s.a,null)),document.getElementById("root"))}.call(this,"/")},67:function(e,t,i){},68:function(e,t,i){},73:function(e,t,i){},74:function(e,t,i){},76:function(e,t,i){},77:function(e,t,i){},78:function(e,t,i){}},[[61,1,2]]]);
//# sourceMappingURL=main.c4e0d4a7.chunk.js.map